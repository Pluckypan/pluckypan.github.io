<!doctype html>
<html lang="zh">
    <head>
    <meta charset="utf-8">
    <meta name="viewport"
        content="width=device-width, initial-scale=1, user-scalable=no, viewport-fit=cover">
    <meta name="theme-color" content="#ffffff">
    <title>
        Hugo - 东方回声
    </title>
    <meta name="description" content="通过 Hugo 揭开 AspectJ(AOP) 与 Annotation (注解)的面纱">
    <meta name="author" content="plucky">
    <meta vmid="keywords" name="keywords" content="来自东方的声音">
    <link rel="shortcut icon" href="../assets/favicon.ico"
        type="image/x-icon">
    <link rel="icon" href="../assets/favicon.ico"
        type="image/x-icon">
    <script src="../js/dt.js"></script>
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/jquery.svg.js"></script>
    <link rel="stylesheet"
        href="../css/bytedesign.min.css">
    <link rel="stylesheet"
        href="../css/app.css">
    <link rel="stylesheet"
        href="../css/default.css">
    <link rel="stylesheet"
        href="../css/jj.css">
    
    <link rel="stylesheet" href="https://at.alicdn.com/t/c/font_4347461_grtef501c9h.css">
    
    <style>
            .footer-tag.width-limited{
                max-width: 120px !important;
            }
        </style>
</head>
    <body>
        <link rel="stylesheet" href="../css/plugins.css">
        <link rel="stylesheet" href="../css/post.css">
        <script src="../js/plugins.js"></script>
        <link
            href="https://cdn.bootcdn.net/ajax/libs/highlight.js/11.9.0/styles/default.min.css"
            rel="stylesheet">
        <script
            src="https://cdn.bootcdn.net/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script>
        <link rel="stylesheet"
            href="https://lf3-cdn-tos.bytescm.com/obj/static/xitu_juejin_web/11.3be290f.css">
        <div data-server-rendered="true" id="__nuxt">
            <div id="__layout">
                <div id="juejin">
                    <div class="view-container" data-v-5762947c data-v-125fc212>
                        <div class="main-header-box" data-v-5762947c>
    <header data-fetch-key="0"
        class="main-header main-header visible"
        data-v-0bba9d46 data-v-5762947c>
        <div class="container" data-v-0bba9d46>
            <a href="../index.html" class="logo" data-v-0bba9d46>
                <img
                    src="../assets/logo.svg"
                    alt="稀土掘金" class="logo-img" data-v-0bba9d46>
                <img
                    src="../assets/logo_mini.svg"
                    alt="稀土掘金" class="mobile" data-v-0bba9d46>
            </a>
            <!---->
            <nav role="navigation" class="main-nav" data-v-0bba9d46>
                <ul class="nav-list" data-v-0bba9d46>
                    <!---->
                    <li class="main-nav-list" data-v-0bba9d46>
                        <div class="phone-show-menu" data-v-0bba9d46>
                            <span data-v-0bba9d46 id="active_title">
                                首页
                            </span>
                            <svg width="12" height="12" viewBox="0 0 12 12"
                                fill="none" xmlns="http://www.w3.org/2000/svg"
                                class="unfold16-icon" data-v-0bba9d46
                                data-v-0bba9d46>
                                <path
                                    d="M2.45025 4.82431C2.17422 4.49957 2.40501 4.00049 2.83122 4.00049H9.16878C9.59498 4.00049 9.82578 4.49957 9.54975 4.82431L6.38097 8.55229C6.1813 8.78719 5.8187 8.78719 5.61903 8.55229L2.45025 4.82431Z"
                                    data-v-0bba9d46 data-v-0bba9d46>
                                </path>
                            </svg>
                        </div>
                        <ul class="phone-hide" data-v-0bba9d46>
                            <li
                                class="nav-item link-item "
                                data-v-0bba9d46>
                                <a href="../index.html"
                                    data-v-0bba9d46>
                                    首页
                                </a>
                            </li>
                            <li
                                class="nav-item link-item activities "
                                data-v-0bba9d46>
                                <a href="../hollow.html"
                                    data-v-0bba9d46>
                                    树洞
                                    <span class="text" data-v-0bba9d46>
                                        <!---->
                                    </span>
                                </a>
                            </li>
                            <li
                                class="nav-item link-item "
                                data-v-0bba9d46>
                                <a href="../events.html"
                                    data-v-0bba9d46>
                                    活动
                                </a>
                            </li>

                            <nav
                                class="nav-item link-item download-icon "
                                data-v-0bba9d46>
                                <a href="../app.html"
                                    class="download-app no-border"
                                    data-v-0bba9d46>
                                    APP
                                </a>
                            </nav>
                            <nav
                                class="nav-item link-item extension-icon "
                                data-v-0bba9d46>
                                <a
                                    href="../plugins.html"
                                    rel="nofollow noopener noreferrer"
                                    class="broswer-extension no-border"
                                    data-v-0bba9d46>
                                    <span data-v-0bba9d46>
                                        插件
                                    </span>
                                </a>
                            </nav>
                            <!---->
                        </ul>
                    </li>
                    <ul class="right-side-nav" data-v-0bba9d46>
                        <li class="search-add" data-v-0bba9d46>
                            <ul class="search-add-ul" data-v-0bba9d46>
                                <li class="nav-item search" data-v-0bba9d46
                                    id="li_search">
                                    <form role="search" class="search-form"
                                        data-v-0bba9d46>
                                        <input type="search" maxlength="64"
                                            placeholder
                                            value class="search-input"
                                            data-v-0bba9d46>
                                        <div class="seach-icon-container"
                                            data-v-0bba9d46>
                                            <svg width="18" height="18"
                                                viewBox="0 0 18 18" fill="none"
                                                xmlns="http://www.w3.org/2000/svg"
                                                class="search-icon"
                                                id="search_icon_x"
                                                data-v-0bba9d46
                                                data-v-0bba9d46>
                                                <path
                                                    d="M12.4008 12.4008C14.744 10.0577 14.744 6.25871 12.4008 3.91556C10.0577 1.57242 6.25871 1.57242 3.91556 3.91556C1.57242 6.25871 1.57242 10.0577 3.91556 12.4008C6.25871 14.744 10.0577 14.744 12.4008 12.4008ZM12.4008 12.4008L15.5828 15.5828"
                                                    stroke-width="1.5"
                                                    stroke-linecap="round"
                                                    stroke-linejoin="round"
                                                    data-v-0bba9d46
                                                    data-v-0bba9d46>
                                                </path>
                                            </svg>
                                        </div>
                                        <!---->
                                        <div class="typehead"
                                            style="display:none;"
                                            data-v-0bba9d46>
                                            <!---->
                                            <div class="title" data-v-0bba9d46>
                                                <span data-v-0bba9d46>
                                                    搜索历史
                                                </span>
                                                <span class="clear"
                                                    data-v-0bba9d46>
                                                    清空
                                                </span>
                                            </div>
                                            <div class="list" data-v-0bba9d46>
                                            </div>
                                        </div>
                                    </form>
                                </li>
                                <li class="nav-item add creator-item"
                                    id="li_add"
                                    data-v-0bba9d46>
                                    <div class="add-group" data-v-17cc1c49
                                        data-v-0bba9d46>
                                        <!---->
                                        <button class="add-btn" data-v-17cc1c49>
                                            创作者中心
                                        </button>
                                        <div class="more" data-v-17cc1c49>
                                            <svg width="12" height="12"
                                                viewBox="0 0 12 12" fill="none"
                                                xmlns="http://www.w3.org/2000/svg"
                                                class="unfold12-icon"
                                                data-v-17cc1c49
                                                data-v-17cc1c49>
                                                <path
                                                    d="M2.45025 4.82383C2.17422 4.49908 2.40501 4 2.83122 4H9.16878C9.59499 4 9.82578 4.49908 9.54975 4.82382L6.38097 8.5518C6.1813 8.7867 5.8187 8.7867 5.61903 8.5518L2.45025 4.82383Z"
                                                    fill="white" data-v-17cc1c49
                                                    data-v-17cc1c49>
                                                </path>
                                            </svg>
                                            <div class="more-mask"
                                                data-v-17cc1c49>
                                            </div>
                                            <div class="more-list"
                                                data-v-17cc1c49><ul
                                                    class="menu" data-v-17cc1c49><li
                                                        class="item"
                                                        data-v-17cc1c49><div
                                                            class="icon write-article"
                                                            data-v-17cc1c49></div>
                                                        <div
                                                            class="title"
                                                            data-v-17cc1c49>写文章</div></li><li
                                                        class="item"
                                                        data-v-17cc1c49><div
                                                            class="icon issue-points"
                                                            data-v-17cc1c49></div>
                                                        <div
                                                            class="title"
                                                            data-v-17cc1c49>发沸点</div></li><li
                                                        class="item"
                                                        data-v-17cc1c49><div
                                                            class="icon write-note"
                                                            data-v-17cc1c49></div>
                                                        <div
                                                            class="title"
                                                            data-v-17cc1c49>写笔记</div></li><li
                                                        class="item"
                                                        data-v-17cc1c49><div
                                                            class="icon create-jcode"
                                                            data-v-17cc1c49></div>
                                                        <div
                                                            class="title"
                                                            data-v-17cc1c49>写代码</div></li><li
                                                        class="item"
                                                        data-v-17cc1c49><div
                                                            class="icon drafts"
                                                            data-v-17cc1c49></div>
                                                        <div class="title"
                                                            data-v-17cc1c49>草稿箱</div></li></ul>
                                                <div class="divider"
                                                    data-v-17cc1c49></div>
                                                <div class="inspiration"
                                                    data-v-17cc1c49><div
                                                        class="info"
                                                        data-v-17cc1c49><span
                                                            class="title"
                                                            data-v-17cc1c49>创作灵感</span>
                                                        <span class="more-info"
                                                            data-v-17cc1c49>
                                                            查看更多
                                                            <i
                                                                class="icon byte-icon byte-icon--right"
                                                                data-v-17cc1c49><svg
                                                                    t="1561636167146"
                                                                    class="icon"
                                                                    viewBox="0 0 1024 1024"
                                                                    version="1.1"
                                                                    xmlns="http://www.w3.org/2000/svg"
                                                                    p-id="404349"
                                                                    xmlns:xlink="http://www.w3.org/1999/xlink"><path
                                                                        d="M630.4 512L283.52 165.12a21.12 21.12 0 0 1 0-30.08l30.08-30.08a21.12 21.12 0 0 1 30.08 0l377.6 376.96a42.24 42.24 0 0 1 0 60.16l-377.6 376.96a21.12 21.12 0 0 1-30.08 0l-30.08-30.08a21.12 21.12 0 0 1 0-30.08z"
                                                                        p-id="404350"></path></svg></i></span></div>
                                                    <div class="list"
                                                        data-v-17cc1c49><div
                                                            data-v-17cc1c49
                                                            class="item"><span
                                                                data-v-17cc1c49
                                                                class="icon icon-activity">热门</span>
                                                            <span
                                                                data-v-17cc1c49
                                                                class="title">写原创好文，瓜分万元现金大奖
                                                                💰 </span></div><div
                                                            data-v-17cc1c49
                                                            class="item"><span
                                                                data-v-17cc1c49
                                                                class="icon icon-activity">热门</span>
                                                            <span
                                                                data-v-17cc1c49
                                                                class="title">快速搬家，掘金写作之旅即刻启航！</span></div>
                                                        <div data-v-17cc1c49
                                                            class="item"><span
                                                                data-v-17cc1c49
                                                                class="icon icon-topic">话题</span>
                                                            <span
                                                                data-v-17cc1c49
                                                                class="title topic-title">1024一起掘金</span></div>
                                                        <div class="item"
                                                            data-v-090682e2
                                                            data-v-17cc1c49></div></div></div></div>
                                        </div>
                                    </div>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </ul>
            </nav>
        </div>
    </header>
    <script type="text/javascript">
        $(".search-input").focus(()=>{
            $("#li_search").addClass("active");
            $(".search-form").addClass("active");
            $("#search_icon_x").attr('class',"active search-icon");
            $("#li_add").addClass("hide");
        });
        $(".search-input").focusout(()=>{
            $("#li_search").removeClass("active");
            $("#li_add").removeClass("hide");
            $(".search-form").removeClass("active");
            $("#search_icon_x").attr('class',"search-icon");
        });
        $(".phone-show-menu").click(()=>{
            $(".phone-hide").addClass("show");
        });
        $("body").click((e)=>{
            let ele = $(".phone-show-menu");
            if (!ele.is(e.target) && ele.has(e.target).length==0) {
                $(".phone-hide").removeClass("show");    
            }
        });
        $(()=>{
            $("#active_title").text($(".phone-hide>.nav-item.active").text());
        });
    </script>
</div>
                        <main class="container main-container"
                            style="max-width:1140px;"
                            data-v-5762947c>
                            <div class="view column-view"
                                data-v-5762947c
                                data-v-125fc212> <div
                                    class="main-area article-area"
                                    data-v-5762947c data-v-125fc212>
                                    <article itemscope="itemscope"
                                        itemtype="http://schema.org/Article"
                                        data-entry-id="7022606372126588941"
                                        data-draft-id="7022605269393735717"
                                        data-original-type="0"
                                        class="article"
                                        data-v-125fc212 data-v-5762947c>
                                        <h1 class="article-title"
                                            data-v-125fc212>
                                            Hugo
                                        </h1>
                                        <div class="author-info-block"
    data-v-125fc212>
    <div class="author-info-box"
        data-v-125fc212>
        <div class="author-name"
            data-v-125fc212>
            <a
                href="/user/2190663523246765/posts"
                target="_blank"
                rel
                class="username username ellipsis"
                data-v-1800aadb
                data-v-125fc212>
                <span class="name"
                    style="max-width:160px;"
                    data-v-1800aadb>
                    Android
                </span>

            </a>
        </div>
        <div class="meta-box"
            data-v-125fc212>
            <time
                class="time"
                data-v-125fc212>
                2022-12-15 21:14:27
            </time>
            <svg width="16" height="16"
                viewBox="0 0 16 16"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
                class="read-icon"
                data-v-125fc212>
                <path
                    d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z"
                    stroke="currentColor"
                    data-v-125fc212>
                </path>
                <circle cx="7.89922"
                    cy="8.00078" r="2.2"
                    stroke="currentColor"
                    data-v-125fc212>
                </circle>
            </svg>
            
            <script async
                src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            <span id="busuanzi_value_page_pv" class="views-count"
                data-v-125fc212>
                0
            </span>
            
        </div>
    </div>
    <div style="flex:1;" data-v-125fc212>
    </div>
</div>
                                        <div id="article-root"
                                            itemprop="articleBody"
                                            class="article-viewer markdown-body cache result"
                                            data-v-125fc212>
                                            <h3 id="hugo的使用">Hugo的使用</h3><ol>
<li><p>根目录 <code>build.gradle</code> 引用</p>
<pre><code> buildscript {
     repositories {
         google()
         jcenter()
     }
     dependencies {
         classpath &#39;com.android.tools.build:gradle:3.1.4&#39;
         classpath &#39;com.jakewharton.hugo:hugo-plugin:1.2.1&#39;
     }
 }
</code></pre></li><li><p><code>module</code> 的 <code>build.gradle</code> 添加如下代码</p>
<pre><code> apply plugin: &#39;com.android.application&#39;
 apply plugin: &#39;com.jakewharton.hugo&#39;
</code></pre></li><li>添加 <code>@DebugLog</code> 注解,目前支持<ul>
<li>支持 <code>TYPE</code> 注解: 类、接口、枚举</li><li>支持 <code>METHOD</code> : 对方法注解</li><li>支持 <code>CONSTRUCTOR</code> :支持构造器注解</li></ul>
</li><li>总结<ul>
<li>当前版本不支持 <code>Kotlin</code>,仅仅支持 <code>Java</code></li><li>可打印 <code>METHOD</code> 方法名、参数、返回值、执行时间</li></ul>
</li></ol>
<h3 id="aspectj 的使用">AspectJ 的使用</h3><ul>
<li>AOP(Aspect Oriented Programming)，即『面向切面编程』</li><li>AspectJ实际上是对AOP编程思想的一个实践</li><li>日志埋点、性能监控、动态权限控制、代码调试</li></ul>
<h4 id="根目录 <code>build.gradle</code> 引用">根目录 <code>build.gradle</code> 引用</h4><pre><code>buildscript {
    dependencies {
        classpath &#39;com.android.tools.build:gradle:3.1.4&#39;
        classpath &#39;org.aspectj:aspectjtools:1.8.10&#39;
    }
}
</code></pre><h4 id="<code>app module</code> 的 <code>build.gradle</code> 添加如下代码"><code>app module</code> 的 <code>build.gradle</code> 添加如下代码</h4><pre><code>apply plugin: &#39;com.android.application&#39;
dependencies {
    api &#39;org.aspectj:aspectjrt:1.8.10&#39;
}
final def log = project.logger
final def variants = project.android.applicationVariants
variants.all { variant -&gt;
    if (!variant.buildType.isDebuggable()) {
        log.debug(&quot;Skipping non-debuggable build type &#39;${variant.buildType.name}&#39;.&quot;)
        return
    }

    JavaCompile javaCompile = variant.javaCompile

    /**
     *在javaCompile任务的最后一步对.class文件进行aspectj处理。加上才可看到class文件注入的变化。
     */
    javaCompile.doLast {
        String[] args = [&quot;-showWeaveInfo&quot;,
                         &quot;-1.8&quot;,
                         &quot;-inpath&quot;, javaCompile.destinationDir.toString(),
                         &quot;-aspectpath&quot;, javaCompile.classpath.asPath,
                         &quot;-d&quot;, javaCompile.destinationDir.toString(),
                         &quot;-classpath&quot;, javaCompile.classpath.asPath,
                         &quot;-bootclasspath&quot;, project.android.bootClasspath.join(File.pathSeparator)]
        log.debug &quot;args: &quot; + Arrays.toString(args)

        MessageHandler handler = new MessageHandler(true)
        new Main().run(args, handler)
        for (IMessage message : handler.getMessages(null, true)) {
            switch (message.getKind()) {
                case IMessage.ABORT:
                case IMessage.ERROR:
                case IMessage.FAIL:
                    log.error message.message, message.thrown
                    break
                case IMessage.WARNING:
                    log.warn message.message, message.thrown
                    break
                case IMessage.INFO:
                    log.info message.message, message.thrown
                    break
                case IMessage.DEBUG:
                    log.debug message.message, message.thrown
                    break
            }
        }
    }
}
</code></pre><h4 id="<code>library module</code> 的 <code>build.gradle</code> 类似"><code>library module</code> 的 <code>build.gradle</code> 类似</h4><pre><code>apply plugin: &#39;com.android.library&#39;
dependencies {
    api &#39;org.aspectj:aspectjrt:1.8.10&#39;
}
android.libraryVariants.all { variant -&gt;
  JavaCompile javaCompile = variant.javaCompile
  javaCompile.doLast {
    def log = project.logger
    String[] args = [
        &quot;-showWeaveInfo&quot;,
        &quot;-1.8&quot;,
        &quot;-inpath&quot;, javaCompile.destinationDir.toString(),
        &quot;-aspectpath&quot;, javaCompile.classpath.asPath,
        &quot;-d&quot;, javaCompile.destinationDir.toString(),
        &quot;-classpath&quot;, javaCompile.classpath.asPath,
        &quot;-bootclasspath&quot;, android.bootClasspath.join(File.pathSeparator)
    ]

    MessageHandler handler = new MessageHandler(true);
    new Main().run(args, handler)

    for (IMessage message : handler.getMessages(null, true)) {
      switch (message.getKind()) {
        case IMessage.ABORT:
        case IMessage.ERROR:
        case IMessage.FAIL:
          log.error message.message, message.thrown
          break;
        case IMessage.WARNING:
        case IMessage.INFO:
          log.info message.message, message.thrown
          break;
        case IMessage.DEBUG:
          log.debug message.message, message.thrown
          break;
      }
    }
  }
}
</code></pre><h4 id="小结">小结</h4><ol>
<li>注意在 <code>app</code> 或者 <code>library</code> 中的配置不一样</li><li>Android Studio 生成的 <code>.class</code> 文件位置 <code>app\build\intermediates\classes</code></li><li>Android Studio 自带的 <code>.class</code> 无法反编译,可以下载并安装插件 <a href='http://jd.benow.ca/?q=jdintellij' title='' target='_blank'>JD-GUI
</a>,注意安装完插件后 关闭Studio自带的反编译插件,然后重启即可生效</li><li>AspectJ产生的文件位置 <code>app\build\intermediates\transforms</code></li><li>代码是在编译阶段织入，所以混淆是不会有影响</li><li>两种方式：<ul>
<li>侵入式,使用自定义注解作为切入点规则</li><li>非侵入式,使用 <code>AspectJ</code> 语法规则匹配切入</li></ul>
</li><li>不支持 <code>Kotlin</code></li></ol>
<h3 id="aspectjx">AspectJX</h3><ol>
<li>基于 <code>AspectJ</code> 面向 <code>Android</code> 的 <code>AspectJ</code> AOP框架</li><li>可作用于java源码，class文件及jar包</li><li>同时支持kotlin</li><li>支持Instant Run编译</li><li>include 和 exclude命令(可通过包名过滤class文件和jar文件)支持 <code>*</code>、<code>**</code>通配符</li><li>项目地址 <a href='https://github.com/HujiangTechnology/gradle_plugin_android_aspectjx' title='' target='_blank'>Github</a></li></ol>
<h4 id="使用步骤">使用步骤</h4><ol>
<li><p>根目录 <code>build.gradle</code> 引用</p>
<pre><code>buildscript {
 dependencies {
     classpath &#39;com.android.tools.build:gradle:3.1.4&#39;
     classpath &#39;com.hujiang.aspectjx:gradle-android-plugin-aspectjx:2.0.4&#39;
 }
}
</code></pre></li><li><p>app <code>build.gradle</code> 引用</p>
<pre><code>apply plugin: &#39;com.android.application&#39;
apply plugin: &#39;android-aspectjx&#39;
android {
 compileSdkVersion 26
 buildToolsVersion &quot;27.0.3&quot;
}
aspectjx {
 enabled true
 //include &#39;android.support&#39;
 //exclude &#39;android.support&#39;
}
</code></pre></li></ol>
<h4 id="示例代码">示例代码</h4><h5 id="测试类">测试类</h5><pre><code>public class Person {
    private int age;
    private int gender;
    private String name;

    public Person() {
    }

    public Person(int age, int gender, String name) {
        this.age = age;
        this.gender = gender;
        this.name = name;
    }

    @Override
    public String toString() {
        return format(name, age, gender);
    }

    public void setAge(int age) {
        this.age = age;
    }

    public int getAge() {
        return age;
    }

    public String format(String name, int age, int gender) {
        String result = String.format(Locale.CHINA, &quot;姓名:%s 年龄:%d 性别:%s&quot;, name, age, gender == 0 ? &quot;男&quot; : &quot;女&quot;);
        Log.i(&quot;aop&quot;, &quot;inner result=&quot; + result);
        return result;
    }

    @Anno
    public int add(int a, int b) {
        return a + b;
    }

    @Anno(aTag = &quot;PY-AOP&quot;, modify = true)
    public int minus(int a, int b) {
        return a - b;
    }
}
</code></pre><h4 id="自定义注解">自定义注解</h4><pre><code>@Target({ElementType.METHOD})
@Retention(RetentionPolicy.RUNTIME)
public @interface Anno {
    String aTag() default &quot;AOP&quot;;

    boolean modify() default false;
}
</code></pre><h4 id="处理类">处理类</h4><pre><code>@Aspect
public class Aspecter {

    @After(&quot;call(* com.echo.camera.Person.toString())&quot;)
    public void aFunc(JoinPoint joinPoint) {
        Log.d(&quot;aop&quot;, &quot;Aspecter aFunc exec&quot;);
    }

    @After(&quot;call(* com.echo.camera.Person.format(..))&quot;)
    public void bFunc(JoinPoint joinPoint) {
        String args = Arrays.toString(joinPoint.getArgs());
        Log.d(&quot;aop&quot;, &quot;Aspecter bFunc exec args=&quot; + args);
    }

   // 一般使用注解可以使用这种方式
    @Pointcut(&quot;execution(@com.echo.camera.Anno * *(..)) &amp;&amp; @annotation(ann)&quot;)
    public void testAnno(Anno ann) {
        Log.i(&quot;aop&quot;, &quot;Aspecter testAnno&quot;);
    }

    @Around(&quot;testAnno(ann)&quot;)
    public Object check(ProceedingJoinPoint joinPoint, Anno ann) throws Throwable {
        String args = Arrays.toString(joinPoint.getArgs());
        Object result;
        if (ann.modify()) {
            Object[] newArgs = {9, 7};
            result = joinPoint.proceed(newArgs);
        } else {
            result = joinPoint.proceed();
        }
        Log.i(&quot;aop&quot;, &quot;Aspecter check args=&quot; + args + &quot; result=&quot; + result + &quot; aTag=&quot; + ann.aTag() + &quot; modify=&quot; + ann.modify());
        return result;
    }
}
</code></pre><h4 id="分析">分析</h4><p>通过以上处理可以在 监控 <code>Person</code> 类的运行状况，并且可以干预运行结果。而一切对源代码的侵入极低(只有注解的时候有侵入)</p>
<h3 id="annotation注解动态生成代码">Annotation注解动态生成代码</h3><ol>
<li>AnnotationProcessor:注解处理器是javac的一个工具，它用来在编译时扫描和处理注解</li><li>可自动导包的代码生成工具<a href='https://github.com/square/javapoet' title='' target='_blank'>javapoet</a> 来自JakeWharton</li><li><p>annotationProcessor 与 android-apt</p>
<blockquote>
<p>android-apt是由一位开发者自己开发的apt框架，随着Android Gradle 插件 2.2 版本的发布，Android Gradle 插件提供了名为 annotationProcessor 的功能来完全代替 android-apt</p>
</blockquote>
</li><li><p>AnnotationProcessor 打印日志</p>
<ul>
<li>javax.annotation.processing.ProcessingEnvironment#getMessager()#printMessage()</li><li>System.out.println()</li></ul>
</li><li><p>gradle 控制台日志</p>
<blockquote>
<p>一般点击 build 或者 run 不会显示 gradle 日志，但是运行 gradle task .比如运行 gradle task. assembleDebug 在 Run 标签下 可以看到 gradle console 日志</p>
</blockquote>
</li><li><p>AutoService</p>
<blockquote>
<p>AutoService注解处理器是Google开发的，用来生成 META-INF/services/javax.annotation.processing.Processor 文件的，你只需要在你定义的注解处理器上添加 @AutoService(Processor.class) 就可以了，简直不能再方便了。</p>
</blockquote>
</li><li><p>获取自定义编译参数</p>
<pre><code> //Processor 中
 String version = processingEnvironment.getOptions().get(&quot;hugox.version&quot;);
 //gradle 中
 defaultConfig {
     applicationId &#39;com.echo.camera&#39;
     javaCompileOptions {
         annotationProcessorOptions {
             arguments = [&#39;hugox.version&#39;: &#39;1.0.0&#39;]
         }
     }
 }
</code></pre></li><li>注解生成代码位置 <code>/build/generated/source/apt</code></li><li>调试 Processor 关键点,无法调试请保证如下几点<ul>
<li>基本操作步骤 请查看 <a href='https://blog.csdn.net/stupid56862/article/details/82224957' title='' target='_blank'>参考链接</a></li><li>在 Run/Debug Configurations 中添加 Remote 调试选项 APT,填写端口号、选择关联module</li><li>在 gradle.properties 中添加 <code>org.gradle.daemon=true</code> <code>org.gradle.jvmargs=-agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=5005</code></li><li>点击调试按钮即可</li><li>一般情况下断点能激活，但是有时候无法单步调用，只要清除掉 <code>app\build\intermediates\transforms</code> 目录下的文件即可</li><li>如果直接点击运行项目无法断点 可尝试 gradle task <code>assembleDebug</code> 即可</li></ul>
</li></ol>
<h4 id="annotationprocessor 的使用">AnnotationProcessor 的使用</h4><ol>
<li><p>新建一个Java Lib库 HugoXAnno，其gradle配置文件如下</p>
<pre><code>   apply plugin: &#39;java-library&#39;

   dependencies {
       implementation fileTree(dir: &#39;libs&#39;, include: [&#39;*.jar&#39;])
   }

   sourceCompatibility = JavaVersion.VERSION_1_7
   targetCompatibility = JavaVersion.VERSION_1_7
</code></pre></li><li><p>定义一个注解 DebugLog 注解，其源码如下</p>
<pre><code>   @Target({TYPE, METHOD, CONSTRUCTOR})
   @Documented
   @Retention(RetentionPolicy.CLASS)
   public @interface DebugLog {

   }
</code></pre></li><li><p>新建一个Java lib库 HugoXCompiler，并引用上面定义的annotations库,并引用上面自定义的注解</p>
<pre><code>   apply plugin: &#39;java-library&#39;

   dependencies {
     implementation fileTree(include: [&#39;*.jar&#39;], dir: &#39;libs&#39;)
     implementation project(&#39;:HugoXAnno&#39;)
     implementation &#39;com.google.auto.service:auto-service:1.0-rc4&#39;
     implementation &#39;com.squareup:javapoet:1.11.1&#39;
   }

   sourceCompatibility = JavaVersion.VERSION_1_7
   targetCompatibility = JavaVersion.VERSION_1_7
</code></pre></li><li>用最原始的方式生成代码<pre><code>   public static boolean testCreateFile(Filer filer) {
     try {
         JavaFileObject f = filer.createSourceFile(&quot;engineer.echo.HelloWorld&quot;);
         Writer w = f.openWriter();
         try {
             PrintWriter pw = new PrintWriter(w);
             pw.println(&quot;//This codes are generated automatically. Do not modify!&quot;);
             pw.println(&quot;package engineer.echo;&quot;);
             pw.println(&quot;public class HelloWorld{&quot;);
             pw.println(&quot; public void print() {&quot;);
             pw.println(&quot;  System.out.println(\&quot;Hello Engineer!\&quot;);&quot;);
             pw.println(&quot; }&quot;);
             pw.println(&quot;}&quot;);
             pw.flush();
         } finally {
             w.close();
         }
         return true;
     } catch (IOException x) {
         return false;
     }
   }
</code></pre></li><li><p>javapoet 生成代码</p>
<pre><code>   public static boolean testJavapoet(Filer filer, String name, int age) {

           //创建main方法
           MethodSpec main = MethodSpec.methodBuilder(&quot;main&quot;)
                   .addModifiers(Modifier.PUBLIC, Modifier.STATIC)
                   .returns(void.class)
                   .addParameter(String[].class, &quot;args&quot;)
                   .addStatement(&quot;$T.out.println($S)&quot;, System.class, &quot;Hello, JavaPoet!&quot;)
                   .build();
           //创建成员变量 TAG
           FieldSpec tag = FieldSpec.builder(String.class, &quot;TAG&quot;)
                   .addModifiers(Modifier.FINAL, Modifier.STATIC, Modifier.PRIVATE)
                   .initializer(&quot;$S&quot;, &quot;Engineer&quot;)
                   .build();
           //创建成员变量 name
           FieldSpec aName = FieldSpec.builder(String.class, &quot;name&quot;)
                   .addModifiers(Modifier.PRIVATE)
                   .initializer(&quot;$S&quot;, name)
                   .build();
           //创建成员变量 age
           FieldSpec aAge = FieldSpec.builder(int.class, &quot;age&quot;)
                   .addModifiers(Modifier.PRIVATE)
                   .initializer(&quot;$L&quot;, age)
                   .build();
           //创建方法 method
           MethodSpec say = MethodSpec.methodBuilder(&quot;say&quot;)
                   .addModifiers(Modifier.PUBLIC)
                   .returns(String.class)
                   .addParameter(String.class, &quot;content&quot;)
                   .addStatement(&quot;String result= $N + $S + $N + $S +$N + $S+$S&quot;,
                           &quot;TAG&quot;, &quot; -&gt; I Am &quot;, &quot;name&quot;, &quot;,I&#39;m &quot;, &quot;age&quot;, &quot;years old.\n&quot;, &quot;content&quot;)
                   .addStatement(&quot;System.out.println(result)&quot;)
                   .addStatement(&quot;return $S&quot;, &quot;result&quot;)
                   .build();

           // 创建 HiWorld 类
           TypeSpec hiWorld = TypeSpec.classBuilder(&quot;HiWorld&quot;)
                   .addModifiers(Modifier.PUBLIC, Modifier.FINAL)
                   .addMethod(main)
                   .addMethod(say)
                   .addField(tag)
                   .addField(aName)
                   .addField(aAge)
                   .build();
           JavaFile javaFile = JavaFile.builder(&quot;engineer.echo&quot;, hiWorld)
                   .addFileComment(&quot;This codes are generated automatically. Do not modify!&quot;)
                   .build();
           try {
               javaFile.writeTo(filer);
               return true;
           } catch (IOException e) {
               //e.printStackTrace();
               return false;
           }
       }
</code></pre></li></ol>
<h4 id="processor示例代码">Processor示例代码</h4><pre><code>  @AutoService(Processor.class)
  @SupportedSourceVersion(SourceVersion.RELEASE_7)
  public class HugoXCompiler extends AbstractProcessor {

      private Filer mFiler;
      private Messager mMessage;
      private String version = &quot;0.0.0&quot;;
      private String name = &quot;xxx&quot;;
      private int age = 0;

      @Override
      public synchronized void init(ProcessingEnvironment processingEnvironment) {
          super.init(processingEnvironment);
          //日志打印
          mMessage = processingEnvironment.getMessager();
          //文件生成器
          mFiler = processingEnvironment.getFiler();
          //获取项目配置的编译参数
          version = processingEnvironment.getOptions().get(&quot;hugox.version&quot;);
          name = processingEnvironment.getOptions().get(&quot;hugox.name&quot;);
          String ageX = processingEnvironment.getOptions().get(&quot;hugox.age&quot;);
          try {
              age = Integer.valueOf(ageX);
          } catch (NumberFormatException e) {

          }
          printLn(&quot;init version=&quot; + version + &quot; name=&quot; + name + &quot; age=&quot; + age, true);
      }

      @Override
      public boolean process(Set&lt;? extends TypeElement&gt; set, RoundEnvironment roundEnvironment) {
          for (Element element : roundEnvironment.getElementsAnnotatedWith(DebugLog.class)) {
              if (element.getKind() == ElementKind.METHOD) {
                  printLn(&quot;------------------------------&quot;, true);
                  printLn(&quot;方法名：&quot; + element.getSimpleName(), true);
                  DebugLog ano = element.getAnnotation(DebugLog.class);
                  printLn(&quot;注解信息：&quot; + ano.showSpendTime(), true);
                  printLn(&quot;------------------------------&quot;, true);
              }
          }
          //原始方法生成java类
          OldTime.testCreateFile(mFiler);
          //javapoet生成代码
          NewTime.testJavapoet(mFiler, name, age);
          return true;
      }

      @Override
      public Set&lt;String&gt; getSupportedAnnotationTypes() {
          /**
           * 指定将要扫描并处理被注解标记的类 有两种方式
           * 1. 重写 public Set&lt;String&gt; getSupportedAnnotationTypes()
           * 2. 在 HugoXCompiler 类头部使用注解 @SupportedAnnotationTypes(&quot;engineer.echo.hugox.DebugLog&quot;)
           */
          return Collections.singleton(DebugLog.class.getCanonicalName());
      }


      /**
       * 指明支持的源码版本(JAVA版本) 支持两种方式
       * 1. 重写 public SourceVersion getSupportedSourceVersion()
       * 2. 在 HugoXCompiler 类头部使用注解 @SupportedSourceVersion(SourceVersion.RELEASE_7)
       */
      /*
      @Override
      public SourceVersion getSupportedSourceVersion() {
          return SourceVersion.latestSupported();
      }*/
      private void printLn(String note, boolean system) {
          if (system) {
              System.out.println(note);
          } else {
              //Note 会在控制台 打印 注: xxx
              mMessage.printMessage(Diagnostic.Kind.NOTE, note);
          }
      }
  }
</code></pre><h3 id="编写一个 gradle plugin">编写一个 Gradle Plugin</h3><ol>
<li>三种方式<ul>
<li>直接在 build.gradle 中编写   <a href='https://github.com/Pluckypan/AndroidDaddy/blob/master/camera/build.gradle' title='' target='_blank'>示例链接</a></li><li>plugin源码放到rootProjectDir/buildSrc/src/main/groovy目录下   <a href='https://github.com/Pluckypan/AndroidDaddy/tree/master/buildSrc/src/main/groovy/echo' title='' target='_blank'>示例链接</a></li><li>独立 project 编译成 jar 上传 Maven,然后项目中通过Build Script依赖jar的形式引入   <a href='https://github.com/Pluckypan/AndroidDaddy/tree/master/HugoXPlugin' title='' target='_blank'>示例链接</a></li></ul>
</li><li>第三种方式除了使用 Plugin 类名外(如 <code>apply plugin: engineer.echo.HugoXPlugin</code>),还可以使用别名(如 <code>apply plugin: &#39;hugox-plugin&#39;</code>)，需要在创建Plugin时有如下配置<ul>
<li>在 <code>src/main/resources/META-INF/gradle-plugins</code> 路径下 创建 <code>别名.properties</code>,并添加如下内容 <code>implementation-class=自定义 Plugin 的全路径如 engineer.echo.HugoXPlugin</code></li></ul>
</li><li>自定义的 plugin task 在依赖当前plugin的 moudle的 Gradle -&gt; ProjectXXX  -&gt; moduleXXX -&gt; Tasks -&gt; other 下，点击即可运行   </li><li>通过创建 Java Lib 的形式创建 Module,然后将 <code>src/main/java/</code> 改为 <code>src/main/groovy/</code></li><li>def hasApp = project.plugins.findPlugin(&quot;com.android.application&quot;)</li><li>def ext=project.rootProject.ext<h4 id="示例代码">示例代码</h4></li><li><p>build.gradle代码</p>
<pre><code> apply plugin: &#39;groovy&#39;

 dependencies {
     compile gradleApi()
     compile localGroovy()
 }

 repositories {
     mavenCentral()
 }

 //打包HugoX
 apply plugin: &#39;maven&#39;
 uploadArchives {
     repositories {
         mavenDeployer {
             pom.groupId = &#39;engineer.echo&#39;
             pom.artifactId = &#39;hugox-plugin&#39;
             pom.version = &#39;1.1.0&#39;

             //方式一：发布到 指定文件夹 比如 绝对路径`D:/repos` 相对路径`../localPublish`
             repository(url: uri(&#39;../localPublish&#39;))

             //方式二：发布到 Maven仓库 比如 Sonatype Nexus
             /*
             repository(url: uri(&#39;http://localhost:8081/nexus/content/repositories/thirdparty/&#39;)) {
                 authentication(userName: &quot;admin&quot;, password: &quot;admin123&quot;)
             }
             */
             //发布插件:打开 Gradle 窗口,展开指定的 Library Module,展开 Tasks,展开 upload,双击运行 uploadArchives
         }
     }
 }
</code></pre></li><li><p>创建扩展项 HugoXExtension.groovy</p>
<pre><code> package engineer.echo

 class HugoXExtension {
     //开关
     boolean enable = false
     String version = &quot;1.0.0&quot;
 }
</code></pre></li><li><p>自定义Plugin <code>HugoXPlugin.groovy</code></p>
<pre><code> package engineer.echo

 import org.gradle.api.Plugin
 import org.gradle.api.Project

 class HugoXPlugin implements Plugin&lt;Project&gt; {

     void apply(Project project) {
       //创建HugoX扩展,可以配置开关
       project.extensions.create(&quot;HugoX&quot;, HugoXExtension)
       def enable = false, ver = &quot;xxx&quot;
       project.afterEvaluate {
           //获取HugoX配置的参数
           def extension = project.HugoX
           enable = extension.enable
           ver = extension.version
           println(&quot;HugoXPlugin enable=$enable ver=$ver&quot;)
       }
       //创建任务
       project.task(&#39;showHugoXInfo&#39;) &lt;&lt; {
           println &quot;HugoX switch on= $enable ver=$ver&quot;
       }
     }
 }
</code></pre></li><li>发布插件:打开 Gradle 窗口,展开指定的 Library Module,展开 Tasks,展开 upload,双击运行 uploadArchives</li><li><p>引用插件</p>
<pre><code> buildscript {
     repositories {
         maven {
             //方式一：本地文件夹
             url &#39;file:../localPublish&#39;

             //Maven仓库地址
             //url &#39;http://localhost:8081/nexus/content/repositories/thirdparty/&#39;
         }
     }
     dependencies {
         classpath &#39;engineer.echo:hugox-plugin:1.1.0&#39;
     }
 }

 apply plugin: &#39;hugox-plugin&#39;
 HugoX {
     enable = true
     version = &quot;1.0.2&quot;
 }
</code></pre></li></ol>
<h3 id="参考文档">参考文档</h3><ol>
<li><a href='https://blog.csdn.net/qq_30379689/article/details/82345625' title='' target='_blank'>APT知识简介</a></li><li><a href='https://blog.csdn.net/github_35180164/article/category/6346819' title='' target='_blank'>JAVA注解由浅入深</a></li><li><a href='https://github.com/square/javapoet' title='' target='_blank'>javapoet语法</a></li><li><a href='https://blog.csdn.net/stupid56862/article/details/82224957' title='' target='_blank'>Android Studio 调试 AnnotationProcessor</a></li><li><a href='https://github.com/Pluckypan/AndroidDaddy/tree/master/HugoXCompiler' title='' target='_blank'>本文示例代码</a></li><li><a href='https://github.com/davenkin/gradle-learning' title='' target='_blank'>Gradle Learning</a></li><li><a href='https://www.cnblogs.com/davenkin/tag/gradle/' title='' target='_blank'>Gradle 12讲</a></li><li><a href='https://github.com/helen-x/gradle-plugin-demo' title='' target='_blank'>Gradle插件创建</a></li></ol>

                                        </div>
                                    </article>
                                    <div class="article-end"
                                        data-v-5762947c data-v-125fc212>
                                        
                                    </div>
                                    <div
    data-v-738d100d
    data-v-125fc212
    data-jj-helper="comment-container"
    class="post-comment" data-v-5762947c>
    <link rel="stylesheet" href="../css/gitalk.css">
    
    <div class="message-card add-top" id="comment-card">
	<div class="gitalk_container">
		<div id="gitalk-container"></div>
		<link rel="stylesheet" href="https://unpkg.com/gitalk@latest/dist/gitalk.css"
			async>
		<script src="https://unpkg.com/gitalk@latest/dist/gitalk.min.js" async></script>
		<script type="text/javascript">
			let initGitalk = ()=> {
				if (typeof(Gitalk) == 'undefined') {
                    setTimeout(initGitalk, 20);
                    return;
                } 
				let gitalk = new Gitalk({
				clientID: "7e48ff7dd55f15c9f051",
				clientSecret: "a5a35f0a17ee770eabd97358255ec6839486a7dd",
				repo: "gitalk.echo.engineer",
				owner: "Pluckypan",
				admin: "Pluckypan",
				distractionFreeMode: "true",
				labels: ['post']
			});
				gitalk.render('gitalk-container');
			}
			$(()=>{
				initGitalk();
			})
		</script>
	</div>
</div>
    
</div>
                                </div>
                                <div id="sidebar-container"
                                    class="sidebar article-sidebar"
                                    data-v-5a150454 data-v-125fc212
                                    data-v-5762947c>
                                    <div
    data-v-7e7e812a
    data-v-05741537
    data-v-5a150454
    class="sidebar-block wechat-sidebar-block pure wechat-ad">
    <div data-v-05741537 data-v-7e7e812a class="ad-container">
        <div data-v-05741537 data-v-7e7e812a class="text-container">
            <div data-v-05741537 data-v-7e7e812a class="text-description">
                找对属于你的技术圈子
            </div>

            <div data-v-05741537 data-v-7e7e812a class="text-reply">
                回复「进群」加入官方微信群
            </div>
        </div>
        <img
            data-v-05741537
            data-v-7e7e812a
            src="../assets/qrcode.png"
            loading="lazy"
            class="qr-code" />
    </div>
</div>

                                    <div class data-v-5a150454 id="jj_post_nav">
    <nav
        class="article-catalog catalog-block"
        data-v-6239701c
        data-v-16ed86c3
        data-v-5a150454>
        <div class="catalog-title" data-v-6239701c>
            <div data-v-6239701c>目录</div>
            <div class="direction" data-v-6239701c>
                <div class="word" data-v-6239701c>收起</div>
                <svg
                    id="icon_expand_toogle"
                    width="12"
                    height="12"
                    viewBox="0 0 12 12"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                    class="icon-rotate"
                    data-v-6239701c>
                    <g
                        id="&amp;#229;&amp;#177;&amp;#149;&amp;#229;&amp;#188;&amp;#128;"
                        data-v-6239701c>
                        <path
                            id="&amp;#232;&amp;#183;&amp;#175;&amp;#229;&amp;#190;&amp;#132;"
                            fill-rule="evenodd"
                            clip-rule="evenodd"
                            d="M5.99854 7.93206L10.0644 3.86619C10.162 3.76856 10.3203 3.76856 10.418 3.86619L10.7715 4.21975C10.8691 4.31738 10.8691 4.47567 10.7715 4.5733L6.35209 8.99272C6.15683 9.18798 5.84025 9.18798 5.64498 8.99272L1.22557 4.5733C1.12794 4.47567 1.12794 4.31738 1.22557 4.21975L1.57912 3.86619C1.67675 3.76856 1.83504 3.76856 1.93267 3.86619L5.99854 7.93206Z"
                            fill="#8A919F"
                            data-v-6239701c></path>
                    </g>
                </svg>
            </div>
        </div>
        <div class="catalog-body unfold" data-v-6239701c>
            <ul class="catalog-list" style="margin-top: 0px" data-v-6239701c>
                
                
                
            </ul>
        </div>
    </nav>

    <script type="text/javascript">
        $(".catalog-aTag").click(function(){
            let id = $(this).attr("target_id");
            $('html, body').animate({
                scrollTop: ($(id).offset().top-80)
            }, 798);
        });
        $(".direction").click(function(){
            $(".catalog-title").removeClass("collapse");
            $("#icon_expand_toogle").attr('class', "");
            if ($(".catalog-body").hasClass("fold")) {
                $(".catalog-body").removeClass("fold");
                $(".catalog-body").addClass("unfold");
                $(".direction>.word").text("收起");
                $("#icon_expand_toogle").attr('class', "icon-rotate");
            }else{
                $(".catalog-body").removeClass("unfold");
                $(".catalog-body").addClass("fold");
                $(".catalog-title").addClass("collapse");
                $(".direction>.word").text("展开");
            }
        });
        $(()=>{
            let tocArray = "";
            let fixedTop = $("#jj_post_nav").offset().top;
            let stickyNav = ()=> {
                let scrollTop = $(window).scrollTop();
                // console.log(`scrollTop=${scrollTop} fixedTop=${fixedTop}`);
                if (scrollTop>fixedTop) {
                    $("#jj_post_nav").addClass("jj_sticky");
                } else {
                    $("#jj_post_nav").removeClass("jj_sticky");
                }
            };
            stickyNav();
            $(window).scroll(()=>{
                stickyNav();
            });
            $("#jj_post_nav").css("display",tocArray.length==0?"none":"");
        });
    </script>

</div>

                                </div>
                                <div data-v-125fc212
    class="article-suspended-panel dynamic-data-ready">
    <svg
        data-v-45561e54
        xmlns="http://www.w3.org/2000/svg"
        class
        style="display: none;">
        <symbol
            data-v-45561e54
            id="icon-comment"
            viewBox="0 0 20 20"
            xmlns="http://www.w3.org/2000/svg">
            <path
                data-v-45561e54
                fill-rule="evenodd"
                clip-rule="evenodd"
                d="M4.62739 1.25C2.9347 1.25 1.5625 2.6222 1.5625 4.31489L1.56396 12.643C1.56403 14.3356 2.9362 15.7078 4.62885 15.7078H6.48326L6.93691 17.6869L6.93884 17.6948C7.16894 18.6441 8.28598 19.0599 9.08073 18.4921L12.7965 15.7078H15.5001C17.1928 15.7078 18.565 14.3355 18.565 12.6428L18.5635 4.31477C18.5635 2.62213 17.1913 1.25 15.4986 1.25H4.62739ZM5.98265 9.89255C6.68783 9.89255 7.2595 9.32089 7.2595 8.61571C7.2595 7.91053 6.68783 7.33887 5.98265 7.33887C5.27747 7.33887 4.70581 7.91053 4.70581 8.61571C4.70581 9.32089 5.27747 9.89255 5.98265 9.89255ZM9.95604 9.89255C10.6612 9.89255 11.2329 9.32089 11.2329 8.61571C11.2329 7.91053 10.6612 7.33887 9.95604 7.33887C9.25086 7.33887 8.6792 7.91053 8.6792 8.61571C8.6792 9.32089 9.25086 9.89255 9.95604 9.89255ZM15.2124 8.61571C15.2124 9.32089 14.6407 9.89255 13.9355 9.89255C13.2304 9.89255 12.6587 9.32089 12.6587 8.61571C12.6587 7.91053 13.2304 7.33887 13.9355 7.33887C14.6407 7.33887 15.2124 7.91053 15.2124 8.61571Z"></path>
        </symbol>
        <symbol
            data-v-45561e54 id="icon-zan"
            viewBox="0 0 20 20"
            xmlns="http://www.w3.org/2000/svg">
            <path
                data-v-45561e54
                fill-rule="evenodd"
                clip-rule="evenodd"
                d="M10.4167 6.40399C5.35406 6.40399 1.25 10.5675 1.25 15.7035C1.25 16.0225 1.28448 16.4512 1.35344 16.9898C1.36807 17.1039 1.47243 17.1846 1.58655 17.17C1.6483 17.1621 1.70328 17.127 1.73643 17.0743L1.86865 16.8676C1.99553 16.6731 2.10644 16.5147 2.20137 16.3925C3.69554 14.4692 6.13777 13.3823 9.35515 13.3378L10.4167 13.3364V17.0757C10.4167 17.3101 10.6086 17.5 10.8453 17.5C10.959 17.5 11.068 17.4553 11.1483 17.3757L18.145 10.45C18.3961 10.2015 18.3961 9.79853 18.145 9.55L11.1483 2.62426C10.981 2.45858 10.7096 2.45858 10.5422 2.62426C10.4618 2.70383 10.4167 2.81174 10.4167 2.92426V6.40399Z"></path>
        </symbol>
        <symbol
            data-v-45561e54
            id="icon-immerse"
            viewBox="0 0 1024 1024"
            xmlns="http://www.w3.org/2000/svg">
            <path
                data-v-45561e54
                fill-rule="evenodd"
                clip-rule="evenodd"
                d="M535.466667 241.066667c-12.8-8.533333-27.733333-8.533333-40.533334 0L183.466667 488.533333c-6.4 6.4-12.8 14.933333-12.8 23.466667 0 2.133333 0 6.4 2.133333 8.533333 2.133333 12.8 14.933333 21.333333 27.733333 21.333334h155.733334v322.133333c0 19.2 12.8 29.866667 32 29.866667h249.6c21.333333 0 34.133333-12.8 34.133333-29.866667v-320h151.466667c12.8 0 25.6-8.533333 27.733333-21.333333s0-25.6-8.533333-34.133334L535.466667 241.066667zM864 96h-704C142.933333 96 128 110.933333 128 128s14.933333 32 32 32h704c17.066667 0 32-14.933333 32-32s-14.933333-32-32-32z"></path>
        </symbol>
    </svg>
    <div data-v-45561e54 badge="222"
        class="panel-btn with-badge-x">
        <svg
            data-v-6e70c50a
            data-v-45561e54
            class="sprite-icon icon-zan">
            <use
                data-v-6e70c50a
                xlink:href="#icon-zan">
            </use>
        </svg>
    </div>
    <div data-v-45561e54 badge="109"
        class="panel-btn with-badge-x" id="toolbar_btn_comment">
        <svg
            data-v-6e70c50a data-v-45561e54
            class="sprite-icon icon-comment">
            <use
                data-v-6e70c50a
                xlink:href="#icon-comment">
            </use>
        </svg>
    </div>
    <div data-v-45561e54 class="panel-btn" id="toolbar_btn_top">
        <svg
            data-v-6e70c50a
            data-v-45561e54
            class="sprite-icon icon-report">
            <use
                data-v-6e70c50a
                xlink:href="#icon-immerse">
            </use>
        </svg>
    </div>
    <script type="text/javascript">
        $("#toolbar_btn_comment").click(()=>{
            $('html, body').animate({
                scrollTop: ($('#comment-card').offset().top - 120)
            }, 798);
        });
        $("#toolbar_btn_top").click(()=>{
            $('html, body').animate({
                scrollTop: 0
            }, 798);
        });
    </script>
</div>
                            </div>
                        </main>
                    </div>
                    <div class="global-component-box">

                    </div>

                </div>
            </div>
        </div>
    </body>

</html>