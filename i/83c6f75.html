<!doctype html>
<html lang="zh">
    <head>
    <meta charset="utf-8">
    <meta name="viewport"
        content="width=device-width, initial-scale=1, user-scalable=no, viewport-fit=cover">
    <meta name="theme-color" content="#ffffff">
    <title>
        ADB 参考手册 - 东方回声
    </title>
    <meta name="description" content="Android Debug Bridge">
    <meta name="author" content="plucky">
    <meta vmid="keywords" name="keywords" content="来自东方的声音">
    <link rel="shortcut icon" href="../assets/favicon.ico"
        type="image/x-icon">
    <link rel="icon" href="../assets/favicon.ico"
        type="image/x-icon">
    <script src="../js/dt.js"></script>
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/jquery.svg.js"></script>
    <link rel="stylesheet"
        href="../css/bytedesign.min.css">
    <link rel="stylesheet"
        href="../css/app.css">
    <link rel="stylesheet"
        href="../css/default.css">
    <link rel="stylesheet"
        href="../css/jj.css">
    
    <link rel="stylesheet" href="https://at.alicdn.com/t/font_1427835_zgyohh6l1si.css">
    
    <style>
            .footer-tag.width-limited{
                max-width: 120px !important;
            }
        </style>
</head>
    <body>
        <link rel="stylesheet" href="../css/plugins.css">
        <link rel="stylesheet" href="../css/post.css">
        <script src="../js/plugins.js"></script>
        <link
            href="https://cdn.bootcdn.net/ajax/libs/highlight.js/11.9.0/styles/default.min.css"
            rel="stylesheet">
        <script
            src="https://cdn.bootcdn.net/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script>
        <link rel="stylesheet"
            href="https://lf3-cdn-tos.bytescm.com/obj/static/xitu_juejin_web/11.3be290f.css">
        <div data-server-rendered="true" id="__nuxt">
            <div id="__layout">
                <div id="juejin">
                    <div class="view-container" data-v-5762947c data-v-125fc212>
                        <div class="main-header-box" data-v-5762947c>
    <header data-fetch-key="0"
        class="main-header main-header visible"
        data-v-0bba9d46 data-v-5762947c>
        <div class="container" data-v-0bba9d46>
            <a href="../index.html" class="logo" data-v-0bba9d46>
                <img
                    src="../assets/logo.svg"
                    alt="稀土掘金" class="logo-img" data-v-0bba9d46>
                <img
                    src="../assets/logo_mini.svg"
                    alt="稀土掘金" class="mobile" data-v-0bba9d46>
            </a>
            <!---->
            <nav role="navigation" class="main-nav" data-v-0bba9d46>
                <ul class="nav-list" data-v-0bba9d46>
                    <!---->
                    <li class="main-nav-list" data-v-0bba9d46>
                        <div class="phone-show-menu" data-v-0bba9d46>
                            <span data-v-0bba9d46 id="active_title">
                                首页
                            </span>
                            <svg width="12" height="12" viewBox="0 0 12 12"
                                fill="none" xmlns="http://www.w3.org/2000/svg"
                                class="unfold16-icon" data-v-0bba9d46
                                data-v-0bba9d46>
                                <path
                                    d="M2.45025 4.82431C2.17422 4.49957 2.40501 4.00049 2.83122 4.00049H9.16878C9.59498 4.00049 9.82578 4.49957 9.54975 4.82431L6.38097 8.55229C6.1813 8.78719 5.8187 8.78719 5.61903 8.55229L2.45025 4.82431Z"
                                    data-v-0bba9d46 data-v-0bba9d46>
                                </path>
                            </svg>
                        </div>
                        <ul class="phone-hide" data-v-0bba9d46>
                            <li
                                class="nav-item link-item "
                                data-v-0bba9d46>
                                <a href="../index.html"
                                    data-v-0bba9d46>
                                    首页
                                </a>
                            </li>
                            <li
                                class="nav-item link-item activities "
                                data-v-0bba9d46>
                                <a href="../hollow.html"
                                    data-v-0bba9d46>
                                    树洞
                                    <span class="text" data-v-0bba9d46>
                                        <!---->
                                    </span>
                                </a>
                            </li>
                            <li
                                class="nav-item link-item "
                                data-v-0bba9d46>
                                <a href="../events.html"
                                    data-v-0bba9d46>
                                    活动
                                </a>
                            </li>

                            <nav
                                class="nav-item link-item download-icon "
                                data-v-0bba9d46>
                                <a href="../app.html"
                                    class="download-app no-border"
                                    data-v-0bba9d46>
                                    APP
                                </a>
                            </nav>
                            <nav
                                class="nav-item link-item extension-icon "
                                data-v-0bba9d46>
                                <a
                                    href="../plugins.html"
                                    rel="nofollow noopener noreferrer"
                                    class="broswer-extension no-border"
                                    data-v-0bba9d46>
                                    <span data-v-0bba9d46>
                                        插件
                                    </span>
                                </a>
                            </nav>
                            <!---->
                        </ul>
                    </li>
                    <ul class="right-side-nav" data-v-0bba9d46>
                        <li class="search-add" data-v-0bba9d46>
                            <ul class="search-add-ul" data-v-0bba9d46>
                                <li class="nav-item search" data-v-0bba9d46
                                    id="li_search">
                                    <form role="search" class="search-form"
                                        data-v-0bba9d46>
                                        <input type="search" maxlength="64"
                                            placeholder
                                            value class="search-input"
                                            data-v-0bba9d46>
                                        <div class="seach-icon-container"
                                            data-v-0bba9d46>
                                            <svg width="18" height="18"
                                                viewBox="0 0 18 18" fill="none"
                                                xmlns="http://www.w3.org/2000/svg"
                                                class="search-icon"
                                                id="search_icon_x"
                                                data-v-0bba9d46
                                                data-v-0bba9d46>
                                                <path
                                                    d="M12.4008 12.4008C14.744 10.0577 14.744 6.25871 12.4008 3.91556C10.0577 1.57242 6.25871 1.57242 3.91556 3.91556C1.57242 6.25871 1.57242 10.0577 3.91556 12.4008C6.25871 14.744 10.0577 14.744 12.4008 12.4008ZM12.4008 12.4008L15.5828 15.5828"
                                                    stroke-width="1.5"
                                                    stroke-linecap="round"
                                                    stroke-linejoin="round"
                                                    data-v-0bba9d46
                                                    data-v-0bba9d46>
                                                </path>
                                            </svg>
                                        </div>
                                        <!---->
                                        <div class="typehead"
                                            style="display:none;"
                                            data-v-0bba9d46>
                                            <!---->
                                            <div class="title" data-v-0bba9d46>
                                                <span data-v-0bba9d46>
                                                    搜索历史
                                                </span>
                                                <span class="clear"
                                                    data-v-0bba9d46>
                                                    清空
                                                </span>
                                            </div>
                                            <div class="list" data-v-0bba9d46>
                                            </div>
                                        </div>
                                    </form>
                                </li>
                                <li class="nav-item add creator-item"
                                    id="li_add"
                                    data-v-0bba9d46>
                                    <div class="add-group" data-v-17cc1c49
                                        data-v-0bba9d46>
                                        <!---->
                                        <button class="add-btn" data-v-17cc1c49>
                                            创作者中心
                                        </button>
                                        <div class="more" data-v-17cc1c49>
                                            <svg width="12" height="12"
                                                viewBox="0 0 12 12" fill="none"
                                                xmlns="http://www.w3.org/2000/svg"
                                                class="unfold12-icon"
                                                data-v-17cc1c49
                                                data-v-17cc1c49>
                                                <path
                                                    d="M2.45025 4.82383C2.17422 4.49908 2.40501 4 2.83122 4H9.16878C9.59499 4 9.82578 4.49908 9.54975 4.82382L6.38097 8.5518C6.1813 8.7867 5.8187 8.7867 5.61903 8.5518L2.45025 4.82383Z"
                                                    fill="white" data-v-17cc1c49
                                                    data-v-17cc1c49>
                                                </path>
                                            </svg>
                                            <div class="more-mask"
                                                data-v-17cc1c49>
                                            </div>
                                            <div class="more-list"
                                                data-v-17cc1c49><ul
                                                    class="menu" data-v-17cc1c49><li
                                                        class="item"
                                                        data-v-17cc1c49><div
                                                            class="icon write-article"
                                                            data-v-17cc1c49></div>
                                                        <div
                                                            class="title"
                                                            data-v-17cc1c49>写文章</div></li><li
                                                        class="item"
                                                        data-v-17cc1c49><div
                                                            class="icon issue-points"
                                                            data-v-17cc1c49></div>
                                                        <div
                                                            class="title"
                                                            data-v-17cc1c49>发沸点</div></li><li
                                                        class="item"
                                                        data-v-17cc1c49><div
                                                            class="icon write-note"
                                                            data-v-17cc1c49></div>
                                                        <div
                                                            class="title"
                                                            data-v-17cc1c49>写笔记</div></li><li
                                                        class="item"
                                                        data-v-17cc1c49><div
                                                            class="icon create-jcode"
                                                            data-v-17cc1c49></div>
                                                        <div
                                                            class="title"
                                                            data-v-17cc1c49>写代码</div></li><li
                                                        class="item"
                                                        data-v-17cc1c49><div
                                                            class="icon drafts"
                                                            data-v-17cc1c49></div>
                                                        <div class="title"
                                                            data-v-17cc1c49>草稿箱</div></li></ul>
                                                <div class="divider"
                                                    data-v-17cc1c49></div>
                                                <div class="inspiration"
                                                    data-v-17cc1c49><div
                                                        class="info"
                                                        data-v-17cc1c49><span
                                                            class="title"
                                                            data-v-17cc1c49>创作灵感</span>
                                                        <span class="more-info"
                                                            data-v-17cc1c49>
                                                            查看更多
                                                            <i
                                                                class="icon byte-icon byte-icon--right"
                                                                data-v-17cc1c49><svg
                                                                    t="1561636167146"
                                                                    class="icon"
                                                                    viewBox="0 0 1024 1024"
                                                                    version="1.1"
                                                                    xmlns="http://www.w3.org/2000/svg"
                                                                    p-id="404349"
                                                                    xmlns:xlink="http://www.w3.org/1999/xlink"><path
                                                                        d="M630.4 512L283.52 165.12a21.12 21.12 0 0 1 0-30.08l30.08-30.08a21.12 21.12 0 0 1 30.08 0l377.6 376.96a42.24 42.24 0 0 1 0 60.16l-377.6 376.96a21.12 21.12 0 0 1-30.08 0l-30.08-30.08a21.12 21.12 0 0 1 0-30.08z"
                                                                        p-id="404350"></path></svg></i></span></div>
                                                    <div class="list"
                                                        data-v-17cc1c49><div
                                                            data-v-17cc1c49
                                                            class="item"><span
                                                                data-v-17cc1c49
                                                                class="icon icon-activity">热门</span>
                                                            <span
                                                                data-v-17cc1c49
                                                                class="title">写原创好文，瓜分万元现金大奖
                                                                💰 </span></div><div
                                                            data-v-17cc1c49
                                                            class="item"><span
                                                                data-v-17cc1c49
                                                                class="icon icon-activity">热门</span>
                                                            <span
                                                                data-v-17cc1c49
                                                                class="title">快速搬家，掘金写作之旅即刻启航！</span></div>
                                                        <div data-v-17cc1c49
                                                            class="item"><span
                                                                data-v-17cc1c49
                                                                class="icon icon-topic">话题</span>
                                                            <span
                                                                data-v-17cc1c49
                                                                class="title topic-title">1024一起掘金</span></div>
                                                        <div class="item"
                                                            data-v-090682e2
                                                            data-v-17cc1c49></div></div></div></div>
                                        </div>
                                    </div>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </ul>
            </nav>
        </div>
    </header>
    <script type="text/javascript">
        $(".search-input").focus(()=>{
            $("#li_search").addClass("active");
            $(".search-form").addClass("active");
            $("#search_icon_x").attr('class',"active search-icon");
            $("#li_add").addClass("hide");
        });
        $(".search-input").focusout(()=>{
            $("#li_search").removeClass("active");
            $("#li_add").removeClass("hide");
            $(".search-form").removeClass("active");
            $("#search_icon_x").attr('class',"search-icon");
        });
        $(".phone-show-menu").click(()=>{
            $(".phone-hide").addClass("show");
        });
        $("body").click((e)=>{
            let ele = $(".phone-show-menu");
            if (!ele.is(e.target) && ele.has(e.target).length==0) {
                $(".phone-hide").removeClass("show");    
            }
        });
        $(()=>{
            $("#active_title").text($(".phone-hide>.nav-item.active").text());
        });
    </script>
</div>
                        <main class="container main-container"
                            style="max-width:1140px;"
                            data-v-5762947c>
                            <div class="view column-view"
                                data-v-5762947c
                                data-v-125fc212> <div
                                    class="main-area article-area"
                                    data-v-5762947c data-v-125fc212>
                                    <article itemscope="itemscope"
                                        itemtype="http://schema.org/Article"
                                        data-entry-id="7022606372126588941"
                                        data-draft-id="7022605269393735717"
                                        data-original-type="0"
                                        class="article"
                                        data-v-125fc212 data-v-5762947c>
                                        <h1 class="article-title"
                                            data-v-125fc212>
                                            ADB 参考手册
                                        </h1>
                                        <div class="author-info-block"
    data-v-125fc212>
    <div class="author-info-box"
        data-v-125fc212>
        <div class="author-name"
            data-v-125fc212>
            <a
                href="/user/2190663523246765/posts"
                target="_blank"
                rel
                class="username username ellipsis"
                data-v-1800aadb
                data-v-125fc212>
                <span class="name"
                    style="max-width:160px;"
                    data-v-1800aadb>
                    default
                </span>

            </a>
        </div>
        <div class="meta-box"
            data-v-125fc212>
            <time
                class="time"
                data-v-125fc212>
                2022-12-15 21:14:27
            </time>
            <svg width="16" height="16"
                viewBox="0 0 16 16"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
                class="read-icon"
                data-v-125fc212>
                <path
                    d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z"
                    stroke="currentColor"
                    data-v-125fc212>
                </path>
                <circle cx="7.89922"
                    cy="8.00078" r="2.2"
                    stroke="currentColor"
                    data-v-125fc212>
                </circle>
            </svg>
            
            <script async
                src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            <span id="busuanzi_value_page_pv" class="views-count"
                data-v-125fc212>
                0
            </span>
            
        </div>
    </div>
    <div style="flex:1;" data-v-125fc212>
    </div>
</div>
                                        <div id="article-root"
                                            itemprop="articleBody"
                                            class="article-viewer markdown-body cache result"
                                            data-v-125fc212>
                                            <h1 id="-img-src-https-github-com-mzlogin-awesome-adb-raw-master-assets-title-png-alt-awesome-adb-width-auto-height-auto-style-width-autopx-important-height-autopx-important-"><img src='https://github.com/mzlogin/awesome-adb/raw/master/assets/title.png' alt='Awesome Adb' width='auto' height='auto' style='width:autopx !important;height:autopx !important;'></h1><p>ADB，即 <a href='https://developer.android.com/studio/command-line/adb.html' title='' target='_blank'>Android Debug Bridge</a>，它是 Android 开发/测试人员不可替代的强大工具，也是 Android 设备玩家的好玩具。</p>
<p>持续更新中，欢迎提 PR 和 Issue 补充指正，觉得有用的可以将 <a href='https://github.com/mzlogin/awesome-adb' title='' target='_blank'>此 GitHub 仓库</a> Star 收藏备用。</p>
<p><strong>注：</strong> 有部分命令的支持情况可能与 Android 系统版本及定制 ROM 的实现有关。</p>
<h1 id="-img-src-https-github-com-mzlogin-awesome-adb-raw-master-assets-toc-png-alt-table-of-contents-width-auto-height-auto-style-width-autopx-important-height-autopx-important-"><img src='https://github.com/mzlogin/awesome-adb/raw/master/assets/toc.png' alt='Table of Contents' width='auto' height='auto' style='width:autopx !important;height:autopx !important;'></h1><!-- vim-markdown-toc GFM -->
<ul>
<li><a href='#基本用法' title='' target='_blank'>基本用法</a><ul>
<li><a href='#命令语法' title='' target='_blank'>命令语法</a></li><li><a href='#为命令指定目标设备' title='' target='_blank'>为命令指定目标设备</a></li><li><a href='#启动停止' title='' target='_blank'>启动/停止</a></li><li><a href='#查看-adb-版本' title='' target='_blank'>查看 adb 版本</a></li><li><a href='#以-root-权限运行-adbd' title='' target='_blank'>以 root 权限运行 adbd</a></li><li><a href='#指定-adb-server-的网络端口' title='' target='_blank'>指定 adb server 的网络端口</a></li></ul>
</li><li><a href='#设备连接管理' title='' target='_blank'>设备连接管理</a><ul>
<li><a href='#查询已连接设备模拟器' title='' target='_blank'>查询已连接设备/模拟器</a></li><li><a href='#usb-连接' title='' target='_blank'>USB 连接</a></li><li><a href='#无线连接需要借助-usb-线' title='' target='_blank'>无线连接（需要借助 USB 线）</a></li><li><a href='#无线连接无需借助-usb-线' title='' target='_blank'>无线连接（无需借助 USB 线）</a></li></ul>
</li><li><a href='#应用管理' title='' target='_blank'>应用管理</a><ul>
<li><a href='#查看应用列表' title='' target='_blank'>查看应用列表</a><ul>
<li><a href='#所有应用' title='' target='_blank'>所有应用</a></li><li><a href='#系统应用' title='' target='_blank'>系统应用</a></li><li><a href='#第三方应用' title='' target='_blank'>第三方应用</a></li><li><a href='#包名包含某字符串的应用' title='' target='_blank'>包名包含某字符串的应用</a></li></ul>
</li><li><a href='#安装-apk' title='' target='_blank'>安装 APK</a></li><li><a href='#卸载应用' title='' target='_blank'>卸载应用</a></li><li><a href='#清除应用数据与缓存' title='' target='_blank'>清除应用数据与缓存</a></li><li><a href='#查看前台-activity' title='' target='_blank'>查看前台 Activity</a></li><li><a href='#查看正在运行的-services' title='' target='_blank'>查看正在运行的 Services</a></li><li><a href='#查看应用详细信息' title='' target='_blank'>查看应用详细信息</a></li><li><a href='#查看应用安装路径' title='' target='_blank'>查看应用安装路径</a></li></ul>
</li><li><a href='#与应用交互' title='' target='_blank'>与应用交互</a><ul>
<li><a href='#启动应用-调起-activity' title='' target='_blank'>启动应用/ 调起 Activity</a></li><li><a href='#调起-service' title='' target='_blank'>调起 Service</a></li><li><a href='#停止-service' title='' target='_blank'>停止 Service</a></li><li><a href='#发送广播' title='' target='_blank'>发送广播</a></li><li><a href='#强制停止应用' title='' target='_blank'>强制停止应用</a></li><li><a href='#收紧内存' title='' target='_blank'>收紧内存</a></li></ul>
</li><li><a href='#文件管理' title='' target='_blank'>文件管理</a><ul>
<li><a href='#复制设备里的文件到电脑' title='' target='_blank'>复制设备里的文件到电脑</a></li><li><a href='#复制电脑里的文件到设备' title='' target='_blank'>复制电脑里的文件到设备</a></li></ul>
</li><li><a href='#模拟按键输入' title='' target='_blank'>模拟按键/输入</a><ul>
<li><a href='#电源键' title='' target='_blank'>电源键</a></li><li><a href='#菜单键' title='' target='_blank'>菜单键</a></li><li><a href='#home-键' title='' target='_blank'>HOME 键</a></li><li><a href='#返回键' title='' target='_blank'>返回键</a></li><li><a href='#音量控制' title='' target='_blank'>音量控制</a></li><li><a href='#媒体控制' title='' target='_blank'>媒体控制</a></li><li><a href='#点亮熄灭屏幕' title='' target='_blank'>点亮/熄灭屏幕</a></li><li><a href='#滑动解锁' title='' target='_blank'>滑动解锁</a></li><li><a href='#输入文本' title='' target='_blank'>输入文本</a></li></ul>
</li><li><a href='#查看日志' title='' target='_blank'>查看日志</a><ul>
<li><a href='#android-日志' title='' target='_blank'>Android 日志</a><ul>
<li><a href='#按级别过滤日志' title='' target='_blank'>按级别过滤日志</a></li><li><a href='#按-tag-和级别过滤日志' title='' target='_blank'>按 tag 和级别过滤日志</a></li><li><a href='#日志格式' title='' target='_blank'>日志格式</a></li><li><a href='#清空日志' title='' target='_blank'>清空日志</a></li></ul>
</li><li><a href='#内核日志' title='' target='_blank'>内核日志</a></li></ul>
</li><li><a href='#查看设备信息' title='' target='_blank'>查看设备信息</a><ul>
<li><a href='#型号' title='' target='_blank'>型号</a></li><li><a href='#电池状况' title='' target='_blank'>电池状况</a></li><li><a href='#屏幕分辨率' title='' target='_blank'>屏幕分辨率</a></li><li><a href='#屏幕密度' title='' target='_blank'>屏幕密度</a></li><li><a href='#显示屏参数' title='' target='_blank'>显示屏参数</a></li><li><a href='#android_id' title='' target='_blank'>android_id</a></li><li><a href='#imei' title='' target='_blank'>IMEI</a></li><li><a href='#android-系统版本' title='' target='_blank'>Android 系统版本</a></li><li><a href='#ip-地址' title='' target='_blank'>IP 地址</a></li><li><a href='#mac-地址' title='' target='_blank'>Mac 地址</a></li><li><a href='#cpu-信息' title='' target='_blank'>CPU 信息</a></li><li><a href='#内存信息' title='' target='_blank'>内存信息</a></li><li><a href='#更多硬件与系统属性' title='' target='_blank'>更多硬件与系统属性</a></li></ul>
</li><li><a href='#修改设置' title='' target='_blank'>修改设置</a><ul>
<li><a href='#分辨率' title='' target='_blank'>分辨率</a></li><li><a href='#屏幕密度-1' title='' target='_blank'>屏幕密度</a></li><li><a href='#显示区域' title='' target='_blank'>显示区域</a></li><li><a href='#关闭-usb-调试模式' title='' target='_blank'>关闭 USB 调试模式</a></li><li><a href='#允许禁止访问非-sdk-api' title='' target='_blank'>允许/禁止访问非 SDK API</a></li><li><a href='#状态栏和导航栏的显示隐藏' title='' target='_blank'>状态栏和导航栏的显示隐藏</a></li></ul>
</li><li><a href='#实用功能' title='' target='_blank'>实用功能</a><ul>
<li><a href='#屏幕截图' title='' target='_blank'>屏幕截图</a></li><li><a href='#录制屏幕' title='' target='_blank'>录制屏幕</a></li><li><a href='#重新挂载-system-分区为可写' title='' target='_blank'>重新挂载 system 分区为可写</a></li><li><a href='#查看连接过的-wifi-密码' title='' target='_blank'>查看连接过的 WiFi 密码</a></li><li><a href='#设置系统日期和时间' title='' target='_blank'>设置系统日期和时间</a></li><li><a href='#重启手机' title='' target='_blank'>重启手机</a></li><li><a href='#检测设备是否已-root' title='' target='_blank'>检测设备是否已 root</a></li><li><a href='#使用-monkey-进行压力测试' title='' target='_blank'>使用 Monkey 进行压力测试</a></li><li><a href='#开启关闭-wifi' title='' target='_blank'>开启/关闭 WiFi</a></li></ul>
</li><li><a href='#刷机相关命令' title='' target='_blank'>刷机相关命令</a><ul>
<li><a href='#重启到-recovery-模式' title='' target='_blank'>重启到 Recovery 模式</a></li><li><a href='#从-recovery-重启到-android' title='' target='_blank'>从 Recovery 重启到 Android</a></li><li><a href='#重启到-fastboot-模式' title='' target='_blank'>重启到 Fastboot 模式</a></li><li><a href='#通过-sideload-更新系统' title='' target='_blank'>通过 sideload 更新系统</a></li></ul>
</li><li><a href='#安全相关命令' title='' target='_blank'>安全相关命令</a><ul>
<li><a href='#启用禁用-selinux' title='' target='_blank'>启用/禁用 SELinux</a></li><li><a href='#启用禁用-dm_verity' title='' target='_blank'>启用/禁用 dm_verity</a></li></ul>
</li><li><a href='#更多-adb-shell-命令' title='' target='_blank'>更多 adb shell 命令</a><ul>
<li><a href='#查看进程' title='' target='_blank'>查看进程</a></li><li><a href='#查看实时资源占用情况' title='' target='_blank'>查看实时资源占用情况</a></li><li><a href='#查看进程-uid' title='' target='_blank'>查看进程 UID</a></li><li><a href='#其它' title='' target='_blank'>其它</a></li></ul>
</li><li><a href='#常见问题' title='' target='_blank'>常见问题</a><ul>
<li><a href='#启动-adb-server-失败' title='' target='_blank'>启动 adb server 失败</a></li><li><a href='#comandroidddmlibadbcommandrejectedexception' title='' target='_blank'>com.android.ddmlib.AdbCommandRejectedException</a></li></ul>
</li><li><a href='#adb-的非官方实现' title='' target='_blank'>adb 的非官方实现</a></li><li><a href='#相关命令' title='' target='_blank'>相关命令</a></li><li><a href='#致谢' title='' target='_blank'>致谢</a></li><li><a href='#参考链接' title='' target='_blank'>参考链接</a></li></ul>
<!-- vim-markdown-toc -->
<h2 id="基本用法">基本用法</h2><h3 id="命令语法">命令语法</h3><p>adb 命令的基本语法如下：</p>
<pre><code class="lang-sh">adb [-d|-e|-s &lt;serialNumber&gt;] &lt;command&gt;
</code></pre>
<p>如果只有一个设备/模拟器连接时，可以省略掉 <code>[-d|-e|-s &lt;serialNumber&gt;]</code> 这一部分，直接使用 <code>adb &lt;command&gt;</code>。</p>
<h3 id="为命令指定目标设备">为命令指定目标设备</h3><p>如果有多个设备/模拟器连接，则需要为命令指定目标设备。</p>
<div class='table-responsive'><table><thead><tr>
<th>参数</th>
<th>含义</th>
</tr>
</thead><tr>
<td>-d</td>
<td>指定当前唯一通过 USB 连接的 Android 设备为命令目标</td>
</tr>
<tr>
<td>-e</td>
<td>指定当前唯一运行的模拟器为命令目标</td>
</tr>
<tr>
<td><code>-s &lt;serialNumber&gt;</code></td>
<td>指定相应 serialNumber 号的设备/模拟器为命令目标</td>
</tr>
</table></div><p>在多个设备/模拟器连接的情况下较常用的是 <code>-s &lt;serialNumber&gt;</code> 参数，serialNumber 可以通过 <code>adb devices</code> 命令获取。如：</p>
<pre><code class="lang-sh">$ adb devices

List of devices attached
cf264b8f    device
emulator-5554    device
10.129.164.6:5555    device
</code></pre>
<p>输出里的 <code>cf264b8f</code>、<code>emulator-5554</code> 和 <code>10.129.164.6:5555</code> 即为 serialNumber。</p>
<p>比如这时想指定 <code>cf264b8f</code> 这个设备来运行 adb 命令获取屏幕分辨率：</p>
<pre><code class="lang-sh">adb -s cf264b8f shell wm size
</code></pre>
<p>又如想给 <code>10.129.164.6:5555</code> 这个设备安装应用（<em>这种形式的 serialNumber 格式为 <code>&lt;IP&gt;:&lt;Port&gt;</code>，一般为无线连接的设备或 Genymotion 等第三方 Android 模拟器</em>）：</p>
<pre><code class="lang-sh">adb -s 10.129.164.6:5555 install test.apk
</code></pre>
<p><strong>遇到多设备/模拟器的情况均使用这几个参数为命令指定目标设备，下文中为简化描述，不再重复。</strong></p>
<h3 id="启动/停止">启动/停止</h3><p>启动 adb server 命令：</p>
<pre><code class="lang-sh">adb start-server
</code></pre>
<p>（一般无需手动执行此命令，在运行 adb 命令时若发现 adb server 没有启动会自动调起。）</p>
<p>停止 adb server 命令：</p>
<pre><code class="lang-sh">adb kill-server
</code></pre>
<h3 id="查看 adb 版本">查看 adb 版本</h3><p>命令：</p>
<pre><code class="lang-sh">adb version
</code></pre>
<p>示例输出：</p>
<pre><code class="lang-sh">Android Debug Bridge version 1.0.36
Revision 8f855a3d9b35-android
</code></pre>
<h3 id="以 root 权限运行 adbd">以 root 权限运行 adbd</h3><p>adb 的运行原理是 PC 端的 adb server 与手机端的守护进程 adbd 建立连接，然后 PC 端的 adb client 通过 adb server 转发命令，adbd 接收命令后解析运行。</p>
<p>所以如果 adbd 以普通权限执行，有些需要 root 权限才能执行的命令无法直接用 <code>adb xxx</code> 执行。这时可以 <code>adb shell</code> 然后 <code>su</code> 后执行命令，也可以让 adbd 以 root 权限执行，这个就能随意执行高权限命令了。</p>
<p>命令：</p>
<pre><code class="lang-sh">adb root
</code></pre>
<p>正常输出：</p>
<pre><code class="lang-sh">restarting adbd as root
</code></pre>
<p>现在再运行 <code>adb shell</code>，看看命令行提示符是不是变成 <code>#</code> 了？</p>
<p>有些手机 root 后也无法通过 <code>adb root</code> 命令让 adbd 以 root 权限执行，比如三星的部分机型，会提示 <code>adbd cannot run as root in production builds</code>，此时可以先安装 adbd Insecure，然后 <code>adb root</code> 试试。</p>
<p>相应地，如果要恢复 adbd 为非 root 权限的话，可以使用 <code>adb unroot</code> 命令。</p>
<h3 id="指定 adb server 的网络端口">指定 adb server 的网络端口</h3><p>命令：</p>
<pre><code class="lang-sh">adb -P &lt;port&gt; start-server
</code></pre>
<p>默认端口为 5037。</p>
<h2 id="设备连接管理">设备连接管理</h2><h3 id="查询已连接设备/模拟器">查询已连接设备/模拟器</h3><p>命令：</p>
<pre><code class="lang-sh">adb devices
</code></pre>
<p>输出示例：</p>
<pre><code class="lang-sh">List of devices attached
cf264b8f    device
emulator-5554    device
10.129.164.6:5555    device
</code></pre>
<p>输出格式为 <code>[serialNumber] [state]</code>，serialNumber 即我们常说的 SN，state 有如下几种：</p>
<ul>
<li><p><code>offline</code> —— 表示设备未连接成功或无响应。</p>
</li><li><p><code>device</code> —— 设备已连接。注意这个状态并不能标识 Android 系统已经完全启动和可操作，在设备启动过程中设备实例就可连接到 adb，但启动完毕后系统才处于可操作状态。</p>
</li><li><p><code>no device</code> —— 没有设备/模拟器连接。</p>
</li></ul>
<p>以上输出显示当前已经连接了三台设备/模拟器，<code>cf264b8f</code>、<code>emulator-5554</code> 和 <code>10.129.164.6:5555</code> 分别是它们的 SN。从 <code>emulator-5554</code> 这个名字可以看出它是一个 Android 模拟器，而 <code>10.129.164.6:5555</code> 这种形为 <code>&lt;IP&gt;:&lt;Port&gt;</code> 的 serialNumber 一般是无线连接的设备或 Genymotion 等第三方 Android 模拟器。</p>
<p>常见异常输出：</p>
<ol>
<li><p>没有设备/模拟器连接成功。</p>
<pre><code class="lang-sh">List of devices attached
</code></pre>
</li><li><p>设备/模拟器未连接到 adb 或无响应。</p>
<pre><code class="lang-sh">List of devices attached
cf264b8f    offline
</code></pre>
</li></ol>
<h3 id="usb 连接">USB 连接</h3><p>通过 USB 连接来正常使用 adb 需要保证几点：</p>
<ol>
<li><p>硬件状态正常。</p>
<p>包括 Android 设备处于正常开机状态，USB 连接线和各种接口完好。</p>
</li><li><p>Android 设备的开发者选项和 USB 调试模式已开启。</p>
<p>可以到「设置」-「开发者选项」-「Android 调试」查看。</p>
<p>如果在设置里找不到开发者选项，那需要通过一个彩蛋来让它显示出来：在「设置」-「关于手机」连续点击「版本号」7 次。</p>
</li><li><p>设备驱动状态正常。</p>
<p>这一点貌似在 Linux 和 Mac OS X 下不用操心，在 Windows 下有可能遇到需要安装驱动的情况，确认这一点可以右键「计算机」-「属性」，到「设备管理器」里查看相关设备上是否有黄色感叹号或问号，如果没有就说明驱动状态已经好了。否则可以下载一个手机助手类程序来安装驱动先。</p>
</li><li><p>通过 USB 线连接好电脑和设备后确认状态。</p>
<pre><code class="lang-sh">adb devices
</code></pre>
<p>如果能看到</p>
<pre><code class="lang-sh">xxxxxx device
</code></pre>
<p>说明连接成功。</p>
</li></ol>
<h3 id="无线连接（需要借助 usb 线）">无线连接（需要借助 USB 线）</h3><p>除了可以通过 USB 连接设备与电脑来使用 adb，也可以通过无线连接——虽然连接过程中也有需要使用 USB 的步骤，但是连接成功之后你的设备就可以在一定范围内摆脱 USB 连接线的限制啦！</p>
<p>操作步骤：</p>
<ol>
<li><p>将 Android 设备与要运行 adb 的电脑连接到同一个局域网，比如连到同一个 WiFi。</p>
</li><li><p>将设备与电脑通过 USB 线连接。</p>
<p>应确保连接成功（可运行 <code>adb devices</code> 看是否能列出该设备）。</p>
</li><li><p>让设备在 5555 端口监听 TCP/IP 连接：</p>
<pre><code class="lang-sh">adb tcpip 5555
</code></pre>
</li><li><p>断开 USB 连接。</p>
</li><li><p>找到设备的 IP 地址。</p>
<p>一般能在「设置」-「关于手机」-「状态信息」-「IP地址」找到，也可以使用下文里 <a href='#ip-地址' title='' target='_blank'>查看设备信息 - IP 地址</a> 一节里的方法用 adb 命令来查看。</p>
</li><li><p>通过 IP 地址连接设备。</p>
<pre><code class="lang-sh">adb connect &lt;device-ip-address&gt;
</code></pre>
<p>这里的 <code>&lt;device-ip-address&gt;</code> 就是上一步中找到的设备 IP 地址。</p>
</li><li><p>确认连接状态。</p>
<pre><code class="lang-sh">adb devices
</code></pre>
<p>如果能看到</p>
<pre><code class="lang-sh">&lt;device-ip-address&gt;:5555 device
</code></pre>
<p>说明连接成功。</p>
</li></ol>
<p>如果连接不了，请确认 Android 设备与电脑是连接到了同一个 WiFi，然后再次执行 <code>adb connect &lt;device-ip-address&gt;</code> 那一步；</p>
<p>如果还是不行的话，通过 <code>adb kill-server</code> 重新启动 adb 然后从头再来一次试试。</p>
<p><strong>断开无线连接</strong></p>
<p>命令：</p>
<pre><code class="lang-sh">adb disconnect &lt;device-ip-address&gt;
</code></pre>
<h3 id="无线连接（无需借助 usb 线）">无线连接（无需借助 USB 线）</h3><p><strong>注：需要 root 权限。</strong></p>
<p>上一节「无线连接（需要借助 USB 线）」是官方文档里介绍的方法，需要借助于 USB 数据线来实现无线连接。</p>
<p>既然我们想要实现无线连接，那能不能所有步骤下来都是无线的呢？答案是能的。</p>
<ol>
<li><p>在 Android 设备上安装一个终端模拟器。</p>
<p>已经安装过的设备可以跳过此步。我使用的终端模拟器下载地址是：<a href='https://jackpal.github.io/Android-Terminal-Emulator/' title='' target='_blank'>Terminal Emulator for Android Downloads</a></p>
</li><li><p>将 Android 设备与要运行 adb 的电脑连接到同一个局域网，比如连到同一个 WiFi。</p>
</li><li><p>打开 Android 设备上的终端模拟器，在里面依次运行命令：</p>
<pre><code class="lang-sh">su
setprop service.adb.tcp.port 5555
</code></pre>
</li><li><p>找到 Android 设备的 IP 地址。</p>
<p>一般能在「设置」-「关于手机」-「状态信息」-「IP地址」找到，也可以使用下文里 <a href='#ip-地址' title='' target='_blank'>查看设备信息 - IP 地址</a> 一节里的方法用 adb 命令来查看。</p>
</li><li><p>在电脑上通过 adb 和 IP 地址连接 Android 设备。</p>
<pre><code class="lang-sh">adb connect &lt;device-ip-address&gt;
</code></pre>
<p>这里的 <code>&lt;device-ip-address&gt;</code> 就是上一步中找到的设备 IP 地址。</p>
<p>如果能看到 <code>connected to &lt;device-ip-address&gt;:5555</code> 这样的输出则表示连接成功。</p>
</li></ol>
<p><em>节注一：</em></p>
<p>有的设备，比如小米 5S + MIUI 8.0 + Android 6.0.1 MXB48T，可能在第 5 步之前需要重启 adbd 服务，在设备的终端模拟器上运行：</p>
<pre><code class="lang-sh">restart adbd
</code></pre>
<p>如果 restart 无效，尝试以下命令：</p>
<pre><code class="lang-sh">stop adbd
start adbd
</code></pre>
<h2 id="应用管理">应用管理</h2><h3 id="查看应用列表">查看应用列表</h3><p>查看应用列表的基本命令格式是</p>
<pre><code class="lang-sh">adb shell pm list packages [-f] [-d] [-e] [-s] [-3] [-i] [-u] [--user USER_ID] [FILTER]
</code></pre>
<p>即在 <code>adb shell pm list packages</code> 的基础上可以加一些参数进行过滤查看不同的列表，支持的过滤参数如下：</p>
<div class='table-responsive'><table><thead><tr>
<th>参数</th>
<th>显示列表</th>
</tr>
</thead><tr>
<td>无</td>
<td>所有应用</td>
</tr>
<tr>
<td>-f</td>
<td>显示应用关联的 apk 文件</td>
</tr>
<tr>
<td>-d</td>
<td>只显示 disabled 的应用</td>
</tr>
<tr>
<td>-e</td>
<td>只显示 enabled 的应用</td>
</tr>
<tr>
<td>-s</td>
<td>只显示系统应用</td>
</tr>
<tr>
<td>-3</td>
<td>只显示第三方应用</td>
</tr>
<tr>
<td>-i</td>
<td>显示应用的 installer</td>
</tr>
<tr>
<td>-u</td>
<td>包含已卸载应用</td>
</tr>
<tr>
<td><code>&lt;FILTER&gt;</code></td>
<td>包名包含 <code>&lt;FILTER&gt;</code> 字符串</td>
</tr>
</table></div><h4 id="所有应用">所有应用</h4><p>命令：</p>
<pre><code class="lang-sh">adb shell pm list packages
</code></pre>
<p>输出示例：</p>
<pre><code class="lang-sh">package:com.android.smoketest
package:com.example.android.livecubes
package:com.android.providers.telephony
package:com.google.android.googlequicksearchbox
package:com.android.providers.calendar
package:com.android.providers.media
package:com.android.protips
package:com.android.documentsui
package:com.android.gallery
package:com.android.externalstorage
...
// other packages here
...
</code></pre>
<h4 id="系统应用">系统应用</h4><p>命令：</p>
<pre><code class="lang-sh">adb shell pm list packages -s
</code></pre>
<h4 id="第三方应用">第三方应用</h4><p>命令：</p>
<pre><code class="lang-sh">adb shell pm list packages -3
</code></pre>
<h4 id="包名包含某字符串的应用">包名包含某字符串的应用</h4><p>比如要查看包名包含字符串 <code>mazhuang</code> 的应用列表，命令：</p>
<pre><code class="lang-sh">adb shell pm list packages mazhuang
</code></pre>
<p>当然也可以使用 grep 来过滤：</p>
<pre><code class="lang-sh">adb shell pm list packages | grep mazhuang
</code></pre>
<h3 id="安装 apk">安装 APK</h3><p>命令格式：</p>
<pre><code class="lang-sh">adb install [-lrtsdg] &lt;path_to_apk&gt;
</code></pre>
<p>参数：</p>
<p><code>adb install</code> 后面可以跟一些可选参数来控制安装 APK 的行为，可用参数及含义如下：</p>
<div class='table-responsive'><table><thead><tr>
<th>参数</th>
<th>含义</th>
</tr>
</thead><tr>
<td>-l</td>
<td>将应用安装到保护目录 /mnt/asec</td>
</tr>
<tr>
<td>-r</td>
<td>允许覆盖安装</td>
</tr>
<tr>
<td>-t</td>
<td>允许安装 AndroidManifest.xml 里 application 指定 <code>android:testOnly=&quot;true&quot;</code> 的应用</td>
</tr>
<tr>
<td>-s</td>
<td>将应用安装到 sdcard</td>
</tr>
<tr>
<td>-d</td>
<td>允许降级覆盖安装</td>
</tr>
<tr>
<td>-g</td>
<td>授予所有运行时权限</td>
</tr>
</table></div><p>运行命令后如果见到类似如下输出（状态为 <code>Success</code>）代表安装成功：</p>
<pre><code class="lang-sh">[100%] /data/local/tmp/1.apk
    pkg: /data/local/tmp/1.apk
Success
</code></pre>
<p>上面是当前最新版 v1.0.36 的 adb 的输出，会显示 push apk 文件到手机的进度百分比。</p>
<p>使用旧版本 adb 的输出则是这样的：</p>
<pre><code class="lang-sh">12040 KB/s (22205609 bytes in 1.801s)
        pkg: /data/local/tmp/SogouInput_android_v8.3_sweb.apk
Success
</code></pre>
<p>而如果状态为 <code>Failure</code> 则表示安装失败，比如：</p>
<pre><code class="lang-sh">[100%] /data/local/tmp/map-20160831.apk
        pkg: /data/local/tmp/map-20160831.apk
Failure [INSTALL_FAILED_ALREADY_EXISTS]
</code></pre>
<p>常见安装失败输出代码、含义及可能的解决办法如下：</p>
<div class='table-responsive'><table><thead><tr>
<th>输出</th>
<th>含义</th>
<th>解决办法</th>
</tr>
</thead><tr>
<td>INSTALL_FAILED_ALREADY_EXISTS</td>
<td>应用已经存在，或卸载了但没卸载干净</td>
<td><code>adb install</code> 时使用 <code>-r</code> 参数，或者先 <code>adb uninstall &lt;packagename&gt;</code> 再安装</td>
</tr>
<tr>
<td>INSTALL_FAILED_INVALID_APK</td>
<td>无效的 APK 文件</td>
<td></td>
</tr>
<tr>
<td>INSTALL_FAILED_INVALID_URI</td>
<td>无效的 APK 文件名</td>
<td>确保 APK 文件名里无中文</td>
</tr>
<tr>
<td>INSTALL_FAILED_INSUFFICIENT_STORAGE</td>
<td>空间不足</td>
<td>清理空间</td>
</tr>
<tr>
<td>INSTALL_FAILED_DUPLICATE_PACKAGE</td>
<td>已经存在同名程序</td>
<td></td>
</tr>
<tr>
<td>INSTALL_FAILED_NO_SHARED_USER</td>
<td>请求的共享用户不存在</td>
<td></td>
</tr>
<tr>
<td>INSTALL_FAILED_UPDATE_INCOMPATIBLE</td>
<td>以前安装过同名应用，但卸载时数据没有移除；或者已安装该应用，但签名不一致</td>
<td>先 <code>adb uninstall &lt;packagename&gt;</code> 再安装</td>
</tr>
<tr>
<td>INSTALL_FAILED_SHARED_USER_INCOMPATIBLE</td>
<td>请求的共享用户存在但签名不一致</td>
<td></td>
</tr>
<tr>
<td>INSTALL_FAILED_MISSING_SHARED_LIBRARY</td>
<td>安装包使用了设备上不可用的共享库</td>
<td></td>
</tr>
<tr>
<td>INSTALL_FAILED_REPLACE_COULDNT_DELETE</td>
<td>替换时无法删除</td>
<td></td>
</tr>
<tr>
<td>INSTALL_FAILED_DEXOPT</td>
<td>dex 优化验证失败或空间不足</td>
<td></td>
</tr>
<tr>
<td>INSTALL_FAILED_OLDER_SDK</td>
<td>设备系统版本低于应用要求</td>
<td></td>
</tr>
<tr>
<td>INSTALL_FAILED_CONFLICTING_PROVIDER</td>
<td>设备里已经存在与应用里同名的 content provider</td>
<td></td>
</tr>
<tr>
<td>INSTALL_FAILED_NEWER_SDK</td>
<td>设备系统版本高于应用要求</td>
<td></td>
</tr>
<tr>
<td>INSTALL_FAILED_TEST_ONLY</td>
<td>应用是 test-only 的，但安装时没有指定 <code>-t</code> 参数</td>
<td></td>
</tr>
<tr>
<td>INSTALL_FAILED_CPU_ABI_INCOMPATIBLE</td>
<td>包含不兼容设备 CPU 应用程序二进制接口的 native code</td>
<td></td>
</tr>
<tr>
<td>INSTALL_FAILED_MISSING_FEATURE</td>
<td>应用使用了设备不可用的功能</td>
<td></td>
</tr>
<tr>
<td>INSTALL_FAILED_CONTAINER_ERROR</td>
<td>1. sdcard 访问失败;<br />2. 应用签名与 ROM 签名一致，被当作内置应用。</td>
<td>1. 确认 sdcard 可用，或者安装到内置存储;<br />2. 打包时不与 ROM 使用相同签名。</td>
</tr>
<tr>
<td>INSTALL_FAILED_INVALID_INSTALL_LOCATION</td>
<td>1. 不能安装到指定位置;<br />2. 应用签名与 ROM 签名一致，被当作内置应用。</td>
<td>1. 切换安装位置，添加或删除 <code>-s</code> 参数;<br />2. 打包时不与 ROM 使用相同签名。</td>
</tr>
<tr>
<td>INSTALL_FAILED_MEDIA_UNAVAILABLE</td>
<td>安装位置不可用</td>
<td>一般为 sdcard，确认 sdcard 可用或安装到内置存储</td>
</tr>
<tr>
<td>INSTALL_FAILED_VERIFICATION_TIMEOUT</td>
<td>验证安装包超时</td>
<td></td>
</tr>
<tr>
<td>INSTALL_FAILED_VERIFICATION_FAILURE</td>
<td>验证安装包失败</td>
<td></td>
</tr>
<tr>
<td>INSTALL_FAILED_PACKAGE_CHANGED</td>
<td>应用与调用程序期望的不一致</td>
<td></td>
</tr>
<tr>
<td>INSTALL_FAILED_UID_CHANGED</td>
<td>以前安装过该应用，与本次分配的 UID 不一致</td>
<td>清除以前安装过的残留文件</td>
</tr>
<tr>
<td>INSTALL_FAILED_VERSION_DOWNGRADE</td>
<td>已经安装了该应用更高版本</td>
<td>使用 <code>-d</code> 参数</td>
</tr>
<tr>
<td>INSTALL_FAILED_PERMISSION_MODEL_DOWNGRADE</td>
<td>已安装 target SDK 支持运行时权限的同名应用，要安装的版本不支持运行时权限</td>
<td></td>
</tr>
<tr>
<td>INSTALL_PARSE_FAILED_NOT_APK</td>
<td>指定路径不是文件，或不是以 <code>.apk</code> 结尾</td>
<td></td>
</tr>
<tr>
<td>INSTALL_PARSE_FAILED_BAD_MANIFEST</td>
<td>无法解析的 AndroidManifest.xml 文件</td>
<td></td>
</tr>
<tr>
<td>INSTALL_PARSE_FAILED_UNEXPECTED_EXCEPTION</td>
<td>解析器遇到异常</td>
<td></td>
</tr>
<tr>
<td>INSTALL_PARSE_FAILED_NO_CERTIFICATES</td>
<td>安装包没有签名</td>
<td></td>
</tr>
<tr>
<td>INSTALL_PARSE_FAILED_INCONSISTENT_CERTIFICATES</td>
<td>已安装该应用，且签名与 APK 文件不一致</td>
<td>先卸载设备上的该应用，再安装</td>
</tr>
<tr>
<td>INSTALL_PARSE_FAILED_CERTIFICATE_ENCODING</td>
<td>解析 APK 文件时遇到 <code>CertificateEncodingException</code></td>
<td></td>
</tr>
<tr>
<td>INSTALL_PARSE_FAILED_BAD_PACKAGE_NAME</td>
<td>manifest 文件里没有或者使用了无效的包名</td>
<td></td>
</tr>
<tr>
<td>INSTALL_PARSE_FAILED_BAD_SHARED_USER_ID</td>
<td>manifest 文件里指定了无效的共享用户 ID</td>
<td></td>
</tr>
<tr>
<td>INSTALL_PARSE_FAILED_MANIFEST_MALFORMED</td>
<td>解析 manifest 文件时遇到结构性错误</td>
<td></td>
</tr>
<tr>
<td>INSTALL_PARSE_FAILED_MANIFEST_EMPTY</td>
<td>在 manifest 文件里找不到找可操作标签（instrumentation 或 application）</td>
<td></td>
</tr>
<tr>
<td>INSTALL_FAILED_INTERNAL_ERROR</td>
<td>因系统问题安装失败</td>
<td></td>
</tr>
<tr>
<td>INSTALL_FAILED_USER_RESTRICTED</td>
<td>用户被限制安装应用</td>
<td>在开发者选项里将「USB安装」打开，如果已经打开了，那先关闭再打开。</td>
</tr>
<tr>
<td>INSTALL_FAILED_DUPLICATE_PERMISSION</td>
<td>应用尝试定义一个已经存在的权限名称</td>
<td></td>
</tr>
<tr>
<td>INSTALL_FAILED_NO_MATCHING_ABIS</td>
<td>应用包含设备的应用程序二进制接口不支持的 native code</td>
<td></td>
</tr>
<tr>
<td>INSTALL_CANCELED_BY_USER</td>
<td>应用安装需要在设备上确认，但未操作设备或点了取消</td>
<td>在设备上同意安装</td>
</tr>
<tr>
<td>INSTALL_FAILED_ACWF_INCOMPATIBLE</td>
<td>应用程序与设备不兼容</td>
<td></td>
</tr>
<tr>
<td>INSTALL_FAILED_TEST_ONLY</td>
<td>APK 文件是使用 Android Studio 直接 RUN 编译出来的文件</td>
<td>通过 Gradle 的 assembleDebug 或 assembleRelease 重新编译，或者 Generate Signed APK</td>
</tr>
<tr>
<td>does not contain AndroidManifest.xml</td>
<td>无效的 APK 文件</td>
<td></td>
</tr>
<tr>
<td>is not a valid zip file</td>
<td>无效的 APK 文件</td>
<td></td>
</tr>
<tr>
<td>Offline</td>
<td>设备未连接成功</td>
<td>先将设备与 adb 连接成功</td>
</tr>
<tr>
<td>unauthorized</td>
<td>设备未授权允许调试</td>
<td></td>
</tr>
<tr>
<td>error: device not found</td>
<td>没有连接成功的设备</td>
<td>先将设备与 adb 连接成功</td>
</tr>
<tr>
<td>protocol failure</td>
<td>设备已断开连接</td>
<td>先将设备与 adb 连接成功</td>
</tr>
<tr>
<td>Unknown option: -s</td>
<td>Android 2.2 以下不支持安装到 sdcard</td>
<td>不使用 <code>-s</code> 参数</td>
</tr>
<tr>
<td>No space left on device</td>
<td>空间不足</td>
<td>清理空间</td>
</tr>
<tr>
<td>Permission denied ... sdcard ...</td>
<td>sdcard 不可用</td>
<td></td>
</tr>
<tr>
<td>signatures do not match the previously installed version; ignoring!</td>
<td>已安装该应用且签名不一致</td>
<td>先卸载设备上的该应用，再安装</td>
</tr>
</table></div><p>参考：<a href='https://github.com/android/platform_frameworks_base/blob/master/core%2Fjava%2Fandroid%2Fcontent%2Fpm%2FPackageManager.java' title='' target='_blank'>PackageManager.java</a></p>
<p><em><code>adb install</code> 内部原理简介</em></p>
<p><code>adb install</code> 实际是分三步完成：</p>
<ol>
<li><p>push apk 文件到 /data/local/tmp。</p>
</li><li><p>调用 pm install 安装。</p>
</li><li><p>删除 /data/local/tmp 下的对应 apk 文件。</p>
</li></ol>
<p>所以，必要的时候也可以根据这个步骤，手动分步执行安装过程。</p>
<h3 id="卸载应用">卸载应用</h3><p>命令：</p>
<pre><code class="lang-sh">adb uninstall [-k] &lt;packagename&gt;
</code></pre>
<p><code>&lt;packagename&gt;</code> 表示应用的包名，<code>-k</code> 参数可选，表示卸载应用但保留数据和缓存目录。</p>
<p>命令示例：</p>
<pre><code class="lang-sh">adb uninstall com.qihoo360.mobilesafe
</code></pre>
<p>表示卸载 360 手机卫士。</p>
<h3 id="清除应用数据与缓存">清除应用数据与缓存</h3><p>命令：</p>
<pre><code class="lang-sh">adb shell pm clear &lt;packagename&gt;
</code></pre>
<p><code>&lt;packagename&gt;</code> 表示应用名包，这条命令的效果相当于在设置里的应用信息界面点击了「清除缓存」和「清除数据」。</p>
<p>命令示例：</p>
<pre><code class="lang-sh">adb shell pm clear com.qihoo360.mobilesafe
</code></pre>
<p>表示清除 360 手机卫士的数据和缓存。</p>
<h3 id="查看前台 activity">查看前台 Activity</h3><p>命令：</p>
<pre><code class="lang-sh">adb shell dumpsys activity activities | grep mFocusedActivity
</code></pre>
<p>输出示例：</p>
<pre><code class="lang-sh">mFocusedActivity: ActivityRecord{8079d7e u0 com.cyanogenmod.trebuchet/com.android.launcher3.Launcher t42}
</code></pre>
<p>其中的 <code>com.cyanogenmod.trebuchet/com.android.launcher3.Launcher</code> 就是当前处于前台的 Activity。</p>
<h3 id="查看正在运行的 services">查看正在运行的 Services</h3><p>命令：</p>
<pre><code class="lang-sh">adb shell dumpsys activity services [&lt;packagename&gt;]
</code></pre>
<p><code>&lt;packagename&gt;</code> 参数不是必须的，指定 <code>&lt;packagename&gt;</code> 表示查看与某个包名相关的 Services，不指定表示查看所有 Services。</p>
<p><code>&lt;packagename&gt;</code> 不一定要给出完整的包名，比如运行 <code>adb shell dumpsys activity services org.mazhuang</code>，那么包名 <code>org.mazhuang.demo1</code>、<code>org.mazhuang.demo2</code> 和 <code>org.mazhuang123</code> 等相关的 Services 都会列出来。</p>
<h3 id="查看应用详细信息">查看应用详细信息</h3><p>命令：</p>
<pre><code class="lang-sh">adb shell dumpsys package &lt;packagename&gt;
</code></pre>
<p>输出中包含很多信息，包括 Activity Resolver Table、Registered ContentProviders、包名、userId、安装后的文件资源代码等路径、版本信息、权限信息和授予状态、签名版本信息等。</p>
<p><code>&lt;packagename&gt;</code> 表示应用包名。</p>
<p>输出示例：</p>
<pre><code class="lang-sh">Activity Resolver Table:
  Non-Data Actions:
      android.intent.action.MAIN:
        5b4cba8 org.mazhuang.guanggoo/.SplashActivity filter 5ec9dcc
          Action: &quot;android.intent.action.MAIN&quot;
          Category: &quot;android.intent.category.LAUNCHER&quot;
          AutoVerify=false

Registered ContentProviders:
  org.mazhuang.guanggoo/com.tencent.bugly.beta.utils.BuglyFileProvider:
    Provider{7a3c394 org.mazhuang.guanggoo/com.tencent.bugly.beta.utils.BuglyFileProvider}

ContentProvider Authorities:
  [org.mazhuang.guanggoo.fileProvider]:
    Provider{7a3c394 org.mazhuang.guanggoo/com.tencent.bugly.beta.utils.BuglyFileProvider}
      applicationInfo=ApplicationInfo{7754242 org.mazhuang.guanggoo}

Key Set Manager:
  [org.mazhuang.guanggoo]
      Signing KeySets: 501

Packages:
  Package [org.mazhuang.guanggoo] (c1d7f):
    userId=10394
    pkg=Package{55f714c org.mazhuang.guanggoo}
    codePath=/data/app/org.mazhuang.guanggoo-2
    resourcePath=/data/app/org.mazhuang.guanggoo-2
    legacyNativeLibraryDir=/data/app/org.mazhuang.guanggoo-2/lib
    primaryCpuAbi=null
    secondaryCpuAbi=null
    versionCode=74 minSdk=15 targetSdk=25
    versionName=1.1.74
    splits=[base]
    apkSigningVersion=2
    applicationInfo=ApplicationInfo{7754242 org.mazhuang.guanggoo}
    flags=[ HAS_CODE ALLOW_CLEAR_USER_DATA ALLOW_BACKUP ]
    privateFlags=[ RESIZEABLE_ACTIVITIES ]
    dataDir=/data/user/0/org.mazhuang.guanggoo
    supportsScreens=[small, medium, large, xlarge, resizeable, anyDensity]
    timeStamp=2017-10-22 23:50:53
    firstInstallTime=2017-10-22 23:50:25
    lastUpdateTime=2017-10-22 23:50:55
    installerPackageName=com.miui.packageinstaller
    signatures=PackageSignatures{af09595 [53c7caa2]}
    installPermissionsFixed=true installStatus=1
    pkgFlags=[ HAS_CODE ALLOW_CLEAR_USER_DATA ALLOW_BACKUP ]
    requested permissions:
      android.permission.READ_PHONE_STATE
      android.permission.INTERNET
      android.permission.ACCESS_NETWORK_STATE
      android.permission.ACCESS_WIFI_STATE
      android.permission.READ_LOGS
      android.permission.WRITE_EXTERNAL_STORAGE
      android.permission.READ_EXTERNAL_STORAGE
    install permissions:
      android.permission.INTERNET: granted=true
      android.permission.ACCESS_NETWORK_STATE: granted=true
      android.permission.ACCESS_WIFI_STATE: granted=true
    User 0: ceDataInode=1155675 installed=true hidden=false suspended=false stopped=true notLaunched=false enabled=0
      gids=[3003]
      runtime permissions:
        android.permission.READ_EXTERNAL_STORAGE: granted=true
        android.permission.READ_PHONE_STATE: granted=true
        android.permission.WRITE_EXTERNAL_STORAGE: granted=true
    User 999: ceDataInode=0 installed=false hidden=false suspended=false stopped=true notLaunched=true enabled=0
      gids=[3003]
      runtime permissions:


Dexopt state:
  [org.mazhuang.guanggoo]
    Instruction Set: arm64
      path: /data/app/org.mazhuang.guanggoo-2/base.apk
      status: /data/app/org.mazhuang.guanggoo-2/oat/arm64/base.odex [compilation_filter=speed-profile, status=kOatUpToDa
      te]
</code></pre>
<h3 id="查看应用安装路径">查看应用安装路径</h3><p>命令:</p>
<pre><code>adb shell pm path &lt;PACKAGE&gt;
</code></pre><p>输出应用安装路径</p>
<p>输出示例:</p>
<pre><code>adb shell pm path ecarx.weather

package:/data/app/ecarx.weather-1.apk
</code></pre><h2 id="与应用交互">与应用交互</h2><p>主要是使用 <code>am &lt;command&gt;</code> 命令，常用的 <code>&lt;command&gt;</code> 如下：</p>
<div class='table-responsive'><table><thead><tr>
<th>command</th>
<th>用途</th>
</tr>
</thead><tr>
<td><code>start [options] &lt;INTENT&gt;</code></td>
<td>启动 <code>&lt;INTENT&gt;</code> 指定的 Activity</td>
</tr>
<tr>
<td><code>startservice [options] &lt;INTENT&gt;</code></td>
<td>启动 <code>&lt;INTENT&gt;</code> 指定的 Service</td>
</tr>
<tr>
<td><code>broadcast [options] &lt;INTENT&gt;</code></td>
<td>发送 <code>&lt;INTENT&gt;</code> 指定的广播</td>
</tr>
<tr>
<td><code>force-stop &lt;packagename&gt;</code></td>
<td>停止 <code>&lt;packagename&gt;</code> 相关的进程</td>
</tr>
</table></div><p><code>&lt;INTENT&gt;</code> 参数很灵活，和写 Android 程序时代码里的 Intent 相对应。</p>
<p>用于决定 intent 对象的选项如下：</p>
<div class='table-responsive'><table><thead><tr>
<th>参数</th>
<th>含义</th>
</tr>
</thead><tr>
<td><code>-a &lt;ACTION&gt;</code></td>
<td>指定 action，比如 <code>android.intent.action.VIEW</code></td>
</tr>
<tr>
<td><code>-c &lt;CATEGORY&gt;</code></td>
<td>指定 category，比如 <code>android.intent.category.APP_CONTACTS</code></td>
</tr>
<tr>
<td><code>-n &lt;COMPONENT&gt;</code></td>
<td>指定完整 component 名，用于明确指定启动哪个 Activity，如 <code>com.example.app/.ExampleActivity</code></td>
</tr>
</table></div><p><code>&lt;INTENT&gt;</code> 里还能带数据，就像写代码时的 Bundle 一样：</p>
<div class='table-responsive'><table><thead><tr>
<th>参数</th>
<th>含义</th>
</tr>
</thead><tr>
<td><code>--esn &lt;EXTRA_KEY&gt;</code></td>
<td>null 值（只有 key 名）</td>
</tr>
<tr>
<td>`-e</td>
<td>--es &lt;EXTRA_KEY&gt; &lt;EXTRA_STRING_VALUE&gt;`</td>
<td>string 值</td>
</tr>
<tr>
<td><code>--ez &lt;EXTRA_KEY&gt; &lt;EXTRA_BOOLEAN_VALUE&gt;</code></td>
<td>boolean 值</td>
</tr>
<tr>
<td><code>--ei &lt;EXTRA_KEY&gt; &lt;EXTRA_INT_VALUE&gt;</code></td>
<td>integer 值</td>
</tr>
<tr>
<td><code>--el &lt;EXTRA_KEY&gt; &lt;EXTRA_LONG_VALUE&gt;</code></td>
<td>long 值</td>
</tr>
<tr>
<td><code>--ef &lt;EXTRA_KEY&gt; &lt;EXTRA_FLOAT_VALUE&gt;</code></td>
<td>float 值</td>
</tr>
<tr>
<td><code>--eu &lt;EXTRA_KEY&gt; &lt;EXTRA_URI_VALUE&gt;</code></td>
<td>URI</td>
</tr>
<tr>
<td><code>--ecn &lt;EXTRA_KEY&gt; &lt;EXTRA_COMPONENT_NAME_VALUE&gt;</code></td>
<td>component name</td>
</tr>
<tr>
<td><code>--eia &lt;EXTRA_KEY&gt; &lt;EXTRA_INT_VALUE&gt;[,&lt;EXTRA_INT_VALUE...]</code></td>
<td>integer 数组</td>
</tr>
<tr>
<td><code>--ela &lt;EXTRA_KEY&gt; &lt;EXTRA_LONG_VALUE&gt;[,&lt;EXTRA_LONG_VALUE...]</code></td>
<td>long 数组</td>
</tr>
</table></div><h3 id="启动应用/ 调起 activity">启动应用/ 调起 Activity</h3><p>命令格式：</p>
<pre><code class="lang-sh">adb shell am start [options] &lt;INTENT&gt;
</code></pre>
<p>例如：</p>
<pre><code class="lang-sh">adb shell am start -n com.tencent.mm/.ui.LauncherUI
</code></pre>
<p>表示调起微信主界面。</p>
<pre><code class="lang-sh">adb shell am start -n org.mazhuang.boottimemeasure/.MainActivity --es &quot;toast&quot; &quot;hello, world&quot;
</code></pre>
<p>表示调起 <code>org.mazhuang.boottimemeasure/.MainActivity</code> 并传给它 string 数据键值对 <code>toast - hello, world</code>。</p>
<h3 id="调起 service">调起 Service</h3><p>命令格式：</p>
<pre><code class="lang-sh">adb shell am startservice [options] &lt;INTENT&gt;
</code></pre>
<p>例如：</p>
<pre><code class="lang-sh">adb shell am startservice -n com.tencent.mm/.plugin.accountsync.model.AccountAuthenticatorService
</code></pre>
<p>表示调起微信的某 Service。</p>
<p>另外一个典型的用例是如果设备上原本应该显示虚拟按键但是没有显示，可以试试这个：</p>
<pre><code class="lang-sh">adb shell am startservice -n com.android.systemui/.SystemUIService
</code></pre>
<h3 id="停止 service">停止 Service</h3><p>命令格式：</p>
<pre><code class="lang-sh">adb shell am stopservice [options] &lt;INTENT&gt;
</code></pre>
<h3 id="发送广播">发送广播</h3><p>命令格式：</p>
<pre><code class="lang-sh">adb shell am broadcast [options] &lt;INTENT&gt;
</code></pre>
<p>可以向所有组件广播，也可以只向指定组件广播。</p>
<p>例如，向所有组件广播 <code>BOOT_COMPLETED</code>：</p>
<pre><code class="lang-sh">adb shell am broadcast -a android.intent.action.BOOT_COMPLETED
</code></pre>
<p>又例如，只向 <code>org.mazhuang.boottimemeasure/.BootCompletedReceiver</code> 广播 <code>BOOT_COMPLETED</code>：</p>
<pre><code class="lang-sh">adb shell am broadcast -a android.intent.action.BOOT_COMPLETED -n org.mazhuang.boottimemeasure/.BootCompletedReceiver
</code></pre>
<p>这类用法在测试的时候很实用，比如某个广播的场景很难制造，可以考虑通过这种方式来发送广播。</p>
<p>既能发送系统预定义的广播，也能发送自定义广播。如下是部分系统预定义广播及正常触发时机：</p>
<div class='table-responsive'><table><thead><tr>
<th>action</th>
<th>触发时机</th>
</tr>
</thead><tr>
<td>android.net.conn.CONNECTIVITY_CHANGE</td>
<td>网络连接发生变化</td>
</tr>
<tr>
<td>android.intent.action.SCREEN_ON</td>
<td>屏幕点亮</td>
</tr>
<tr>
<td>android.intent.action.SCREEN_OFF</td>
<td>屏幕熄灭</td>
</tr>
<tr>
<td>android.intent.action.BATTERY_LOW</td>
<td>电量低，会弹出电量低提示框</td>
</tr>
<tr>
<td>android.intent.action.BATTERY_OKAY</td>
<td>电量恢复了</td>
</tr>
<tr>
<td>android.intent.action.BOOT_COMPLETED</td>
<td>设备启动完毕</td>
</tr>
<tr>
<td>android.intent.action.DEVICE_STORAGE_LOW</td>
<td>存储空间过低</td>
</tr>
<tr>
<td>android.intent.action.DEVICE_STORAGE_OK</td>
<td>存储空间恢复</td>
</tr>
<tr>
<td>android.intent.action.PACKAGE_ADDED</td>
<td>安装了新的应用</td>
</tr>
<tr>
<td>android.net.wifi.STATE_CHANGE</td>
<td>WiFi 连接状态发生变化</td>
</tr>
<tr>
<td>android.net.wifi.WIFI_STATE_CHANGED</td>
<td>WiFi 状态变为启用/关闭/正在启动/正在关闭/未知</td>
</tr>
<tr>
<td>android.intent.action.BATTERY_CHANGED</td>
<td>电池电量发生变化</td>
</tr>
<tr>
<td>android.intent.action.INPUT_METHOD_CHANGED</td>
<td>系统输入法发生变化</td>
</tr>
<tr>
<td>android.intent.action.ACTION_POWER_CONNECTED</td>
<td>外部电源连接</td>
</tr>
<tr>
<td>android.intent.action.ACTION_POWER_DISCONNECTED</td>
<td>外部电源断开连接</td>
</tr>
<tr>
<td>android.intent.action.DREAMING_STARTED</td>
<td>系统开始休眠</td>
</tr>
<tr>
<td>android.intent.action.DREAMING_STOPPED</td>
<td>系统停止休眠</td>
</tr>
<tr>
<td>android.intent.action.WALLPAPER_CHANGED</td>
<td>壁纸发生变化</td>
</tr>
<tr>
<td>android.intent.action.HEADSET_PLUG</td>
<td>插入耳机</td>
</tr>
<tr>
<td>android.intent.action.MEDIA_UNMOUNTED</td>
<td>卸载外部介质</td>
</tr>
<tr>
<td>android.intent.action.MEDIA_MOUNTED</td>
<td>挂载外部介质</td>
</tr>
<tr>
<td>android.os.action.POWER_SAVE_MODE_CHANGED</td>
<td>省电模式开启</td>
</tr>
</table></div><p><em>（以上广播均可使用 adb 触发）</em></p>
<h3 id="强制停止应用">强制停止应用</h3><p>命令：</p>
<pre><code class="lang-sh">adb shell am force-stop &lt;packagename&gt;
</code></pre>
<p>命令示例：</p>
<pre><code class="lang-sh">adb shell am force-stop com.qihoo360.mobilesafe
</code></pre>
<p>表示停止 360 安全卫士的一切进程与服务。</p>
<h3 id="收紧内存">收紧内存</h3><p>命令：</p>
<pre><code class="lang-sh">adb shell am send-trim-memory  &lt;pid&gt; &lt;level&gt;
</code></pre>
<p>pid: 进程 ID
level:
    HIDDEN、RUNNING_MODERATE、BACKGROUND、
    RUNNING_LOW、MODERATE、RUNNING_CRITICAL、COMPLETE</p>
<p>命令示例：</p>
<pre><code class="lang-sh">adb shell am send-trim-memory 12345 RUNNING_LOW
</code></pre>
<p>表示向 pid=12345 的进程，发出 level=RUNNING_LOW 的收紧内存命令。</p>
<h2 id="文件管理">文件管理</h2><h3 id="复制设备里的文件到电脑">复制设备里的文件到电脑</h3><p>命令：</p>
<pre><code class="lang-sh">adb pull &lt;设备里的文件路径&gt; [电脑上的目录]
</code></pre>
<p>其中 <code>电脑上的目录</code> 参数可以省略，默认复制到当前目录。</p>
<p>例：</p>
<pre><code class="lang-sh">adb pull /sdcard/sr.mp4 ~/tmp/
</code></pre>
<p><em>小技巧：</em>设备上的文件路径可能需要 root 权限才能访问，如果你的设备已经 root 过，可以先使用 <code>adb shell</code> 和 <code>su</code> 命令在 adb shell 里获取 root 权限后，先 <code>cp /path/on/device /sdcard/filename</code> 将文件复制到 sdcard，然后 <code>adb pull /sdcard/filename /path/on/pc</code>。</p>
<h3 id="复制电脑里的文件到设备">复制电脑里的文件到设备</h3><p>命令：</p>
<pre><code class="lang-sh">adb push &lt;电脑上的文件路径&gt; &lt;设备里的目录&gt;
</code></pre>
<p>例：</p>
<pre><code class="lang-sh">adb push ~/sr.mp4 /sdcard/
</code></pre>
<p><em>小技巧：</em>设备上的文件路径普通权限可能无法直接写入，如果你的设备已经 root 过，可以先 <code>adb push /path/on/pc /sdcard/filename</code>，然后 <code>adb shell</code> 和 <code>su</code> 在 adb shell 里获取 root 权限后，<code>cp /sdcard/filename /path/on/device</code>。</p>
<h2 id="模拟按键/输入">模拟按键/输入</h2><p>在 <code>adb shell</code> 里有个很实用的命令叫 <code>input</code>，通过它可以做一些有趣的事情。</p>
<p><code>input</code> 命令的完整 help 信息如下：</p>
<pre><code class="lang-sh">Usage: input [&lt;source&gt;] &lt;command&gt; [&lt;arg&gt;...]

The sources are:
      mouse
      keyboard
      joystick
      touchnavigation
      touchpad
      trackball
      stylus
      dpad
      gesture
      touchscreen
      gamepad

The commands and default sources are:
      text &lt;string&gt; (Default: touchscreen)
      keyevent [--longpress] &lt;key code number or name&gt; ... (Default: keyboard)
      tap &lt;x&gt; &lt;y&gt; (Default: touchscreen)
      swipe &lt;x1&gt; &lt;y1&gt; &lt;x2&gt; &lt;y2&gt; [duration(ms)] (Default: touchscreen)
      press (Default: trackball)
      roll &lt;dx&gt; &lt;dy&gt; (Default: trackball)
</code></pre>
<p>比如使用 <code>adb shell input keyevent &lt;keycode&gt;</code> 命令，不同的 keycode 能实现不同的功能，完整的 keycode 列表详见 <a href='https://developer.android.com/reference/android/view/KeyEvent.html' title='' target='_blank'>KeyEvent</a>，摘引部分我觉得有意思的如下：</p>
<div class='table-responsive'><table><thead><tr>
<th>keycode</th>
<th>含义</th>
</tr>
</thead><tr>
<td>3</td>
<td>HOME 键</td>
</tr>
<tr>
<td>4</td>
<td>返回键</td>
</tr>
<tr>
<td>5</td>
<td>打开拨号应用</td>
</tr>
<tr>
<td>6</td>
<td>挂断电话</td>
</tr>
<tr>
<td>24</td>
<td>增加音量</td>
</tr>
<tr>
<td>25</td>
<td>降低音量</td>
</tr>
<tr>
<td>26</td>
<td>电源键</td>
</tr>
<tr>
<td>27</td>
<td>拍照（需要在相机应用里）</td>
</tr>
<tr>
<td>64</td>
<td>打开浏览器</td>
</tr>
<tr>
<td>82</td>
<td>菜单键</td>
</tr>
<tr>
<td>85</td>
<td>播放/暂停</td>
</tr>
<tr>
<td>86</td>
<td>停止播放</td>
</tr>
<tr>
<td>87</td>
<td>播放下一首</td>
</tr>
<tr>
<td>88</td>
<td>播放上一首</td>
</tr>
<tr>
<td>122</td>
<td>移动光标到行首或列表顶部</td>
</tr>
<tr>
<td>123</td>
<td>移动光标到行末或列表底部</td>
</tr>
<tr>
<td>126</td>
<td>恢复播放</td>
</tr>
<tr>
<td>127</td>
<td>暂停播放</td>
</tr>
<tr>
<td>164</td>
<td>静音</td>
</tr>
<tr>
<td>176</td>
<td>打开系统设置</td>
</tr>
<tr>
<td>187</td>
<td>切换应用</td>
</tr>
<tr>
<td>207</td>
<td>打开联系人</td>
</tr>
<tr>
<td>208</td>
<td>打开日历</td>
</tr>
<tr>
<td>209</td>
<td>打开音乐</td>
</tr>
<tr>
<td>210</td>
<td>打开计算器</td>
</tr>
<tr>
<td>220</td>
<td>降低屏幕亮度</td>
</tr>
<tr>
<td>221</td>
<td>提高屏幕亮度</td>
</tr>
<tr>
<td>223</td>
<td>系统休眠</td>
</tr>
<tr>
<td>224</td>
<td>点亮屏幕</td>
</tr>
<tr>
<td>231</td>
<td>打开语音助手</td>
</tr>
<tr>
<td>276</td>
<td>如果没有 wakelock 则让系统休眠</td>
</tr>
</table></div><p>下面是 <code>input</code> 命令的一些用法举例。</p>
<h3 id="电源键">电源键</h3><p>命令：</p>
<pre><code class="lang-sh">adb shell input keyevent 26
</code></pre>
<p>执行效果相当于按电源键。</p>
<h3 id="菜单键">菜单键</h3><p>命令：</p>
<pre><code class="lang-sh">adb shell input keyevent 82
</code></pre>
<h3 id="home 键">HOME 键</h3><p>命令：</p>
<pre><code class="lang-sh">adb shell input keyevent 3
</code></pre>
<h3 id="返回键">返回键</h3><p>命令：</p>
<pre><code class="lang-sh">adb shell input keyevent 4
</code></pre>
<h3 id="音量控制">音量控制</h3><p>增加音量：</p>
<pre><code class="lang-sh">adb shell input keyevent 24
</code></pre>
<p>降低音量：</p>
<pre><code class="lang-sh">adb shell input keyevent 25
</code></pre>
<p>静音：</p>
<pre><code class="lang-sh">adb shell input keyevent 164
</code></pre>
<h3 id="媒体控制">媒体控制</h3><p>播放/暂停：</p>
<pre><code class="lang-sh">adb shell input keyevent 85
</code></pre>
<p>停止播放：</p>
<pre><code class="lang-sh">adb shell input keyevent 86
</code></pre>
<p>播放下一首：</p>
<pre><code class="lang-sh">adb shell input keyevent 87
</code></pre>
<p>播放上一首：</p>
<pre><code class="lang-sh">adb shell input keyevent 88
</code></pre>
<p>恢复播放：</p>
<pre><code class="lang-sh">adb shell input keyevent 126
</code></pre>
<p>暂停播放：</p>
<pre><code class="lang-sh">adb shell input keyevent 127
</code></pre>
<h3 id="点亮/熄灭屏幕">点亮/熄灭屏幕</h3><p>可以通过上文讲述过的模拟电源键来切换点亮和熄灭屏幕，但如果明确地想要点亮或者熄灭屏幕，那可以使用如下方法。</p>
<p>点亮屏幕：</p>
<pre><code class="lang-sh">adb shell input keyevent 224
</code></pre>
<p>熄灭屏幕：</p>
<pre><code class="lang-sh">adb shell input keyevent 223
</code></pre>
<h3 id="滑动解锁">滑动解锁</h3><p>如果锁屏没有密码，是通过滑动手势解锁，那么可以通过 <code>input swipe</code> 来解锁。</p>
<p>命令（参数以机型 Nexus 5，向上滑动手势解锁举例）：</p>
<pre><code class="lang-sh">adb shell input swipe 300 1000 300 500
</code></pre>
<p>参数 <code>300 1000 300 500</code> 分别表示<code>起始点x坐标 起始点y坐标 结束点x坐标 结束点y坐标</code>。</p>
<h3 id="输入文本">输入文本</h3><p>在焦点处于某文本框时，可以通过 <code>input</code> 命令来输入文本。</p>
<p>命令：</p>
<pre><code class="lang-sh">adb shell input text hello
</code></pre>
<p>现在 <code>hello</code> 出现在文本框了。</p>
<h2 id="查看日志">查看日志</h2><p>Android 系统的日志分为两部分，底层的 Linux 内核日志输出到 /proc/kmsg，Android 的日志输出到 /dev/log。</p>
<h3 id="android 日志">Android 日志</h3><p>命令格式：</p>
<pre><code class="lang-sh">[adb] logcat [&lt;option&gt;] ... [&lt;filter-spec&gt;] ...
</code></pre>
<p>常用用法列举如下：</p>
<h4 id="按级别过滤日志">按级别过滤日志</h4><p>Android 的日志分为如下几个优先级（priority）：</p>
<ul>
<li>V —— Verbose（最低，输出得最多）</li><li>D —— Debug</li><li>I —— Info</li><li>W —— Warning</li><li>E —— Error</li><li>F —— Fatal</li><li>S —— Silent（最高，啥也不输出）</li></ul>
<p>按某级别过滤日志则会将该级别及以上的日志输出。</p>
<p>比如，命令：</p>
<pre><code class="lang-sh">adb logcat *:W
</code></pre>
<p>会将 Warning、Error、Fatal 和 Silent 日志输出。</p>
<p>（<strong>注：</strong> 在 macOS 下需要给 <code>*:W</code> 这样以 <code>*</code> 作为 tag 的参数加双引号，如 <code>adb logcat &quot;*:W&quot;</code>，不然会报错 <code>no matches found: *:W</code>。）</p>
<h4 id="按 tag 和级别过滤日志">按 tag 和级别过滤日志</h4><p><code>&lt;filter-spec&gt;</code> 可以由多个 <code>&lt;tag&gt;[:priority]</code> 组成。</p>
<p>比如，命令：</p>
<pre><code class="lang-sh">adb logcat ActivityManager:I MyApp:D *:S
</code></pre>
<p>表示输出 tag <code>ActivityManager</code> 的 Info 以上级别日志，输出 tag <code>MyApp</code> 的 Debug 以上级别日志，及其它 tag 的 Silent 级别日志（即屏蔽其它 tag 日志）。</p>
<h4 id="日志格式">日志格式</h4><p>可以用 <code>adb logcat -v &lt;format&gt;</code> 选项指定日志输出格式。</p>
<p>日志支持按以下几种 <code>&lt;format&gt;</code>：</p>
<ul>
<li><p>brief</p>
<p>默认格式。格式为：</p>
<pre><code class="lang-sh">&lt;priority&gt;/&lt;tag&gt;(&lt;pid&gt;): &lt;message&gt;
</code></pre>
<p>示例：</p>
<pre><code class="lang-sh">D/HeadsetStateMachine( 1785): Disconnected process message: 10, size: 0
</code></pre>
</li><li><p>process</p>
<p>格式为：</p>
<pre><code class="lang-sh">&lt;priority&gt;(&lt;pid&gt;) &lt;message&gt;
</code></pre>
<p>示例：</p>
<pre><code class="lang-sh">D( 1785) Disconnected process message: 10, size: 0  (HeadsetStateMachine)
</code></pre>
</li><li><p>tag</p>
<p>格式为：</p>
<pre><code class="lang-sh">&lt;priority&gt;/&lt;tag&gt;: &lt;message&gt;
</code></pre>
<p>示例：</p>
<pre><code class="lang-sh">D/HeadsetStateMachine: Disconnected process message: 10, size: 0
</code></pre>
</li><li><p>raw</p>
<p>格式为：</p>
<pre><code class="lang-sh">&lt;message&gt;
</code></pre>
<p>示例：</p>
<pre><code class="lang-sh">Disconnected process message: 10, size: 0
</code></pre>
</li><li><p>time</p>
<p>格式为：</p>
<pre><code class="lang-sh">&lt;datetime&gt; &lt;priority&gt;/&lt;tag&gt;(&lt;pid&gt;): &lt;message&gt;
</code></pre>
<p>示例：</p>
<pre><code class="lang-sh">08-28 22:39:39.974 D/HeadsetStateMachine( 1785): Disconnected process message: 10, size: 0
</code></pre>
</li><li><p>threadtime</p>
<p>格式为：</p>
<pre><code class="lang-sh">&lt;datetime&gt; &lt;pid&gt; &lt;tid&gt; &lt;priority&gt; &lt;tag&gt;: &lt;message&gt;
</code></pre>
<p>示例：</p>
<pre><code class="lang-sh">08-28 22:39:39.974  1785  1832 D HeadsetStateMachine: Disconnected process message: 10, size: 0
</code></pre>
</li><li><p>long</p>
<p>格式为：</p>
<pre><code class="lang-sh">[ &lt;datetime&gt; &lt;pid&gt;:&lt;tid&gt; &lt;priority&gt;/&lt;tag&gt; ]
&lt;message&gt;
</code></pre>
<p>示例：</p>
<pre><code class="lang-sh">[ 08-28 22:39:39.974  1785: 1832 D/HeadsetStateMachine ]
Disconnected process message: 10, size: 0
</code></pre>
</li></ul>
<p>指定格式可与上面的过滤同时使用。比如：</p>
<pre><code class="lang-sh">adb logcat -v long ActivityManager:I *:S
</code></pre>
<h4 id="清空日志">清空日志</h4><pre><code class="lang-sh">adb logcat -c
</code></pre>
<h3 id="内核日志">内核日志</h3><p>命令：</p>
<pre><code class="lang-sh">adb shell dmesg
</code></pre>
<p>输出示例：</p>
<pre><code class="lang-sh">&lt;6&gt;[14201.684016] PM: noirq resume of devices complete after 0.982 msecs
&lt;6&gt;[14201.685525] PM: early resume of devices complete after 0.838 msecs
&lt;6&gt;[14201.753642] PM: resume of devices complete after 68.106 msecs
&lt;4&gt;[14201.755954] Restarting tasks ... done.
&lt;6&gt;[14201.771229] PM: suspend exit 2016-08-28 13:31:32.679217193 UTC
&lt;6&gt;[14201.872373] PM: suspend entry 2016-08-28 13:31:32.780363596 UTC
&lt;6&gt;[14201.872498] PM: Syncing filesystems ... done.
</code></pre>
<p>中括号里的 <code>[14201.684016]</code> 代表内核开始启动后的时间，单位为秒。</p>
<p>通过内核日志我们可以做一些事情，比如衡量内核启动时间，在系统启动完毕后的内核日志里找到 <code>Freeing init memory</code> 那一行前面的时间就是。</p>
<h2 id="查看设备信息">查看设备信息</h2><h3 id="型号">型号</h3><p>命令：</p>
<pre><code class="lang-sh">adb shell getprop ro.product.model
</code></pre>
<p>输出示例：</p>
<pre><code class="lang-sh">Nexus 5
</code></pre>
<h3 id="电池状况">电池状况</h3><p>命令：</p>
<pre><code class="lang-sh">adb shell dumpsys battery
</code></pre>
<p>输入示例：</p>
<pre><code class="lang-sh">Current Battery Service state:
  AC powered: false
  USB powered: true
  Wireless powered: false
  status: 2
  health: 2
  present: true
  level: 44
  scale: 100
  voltage: 3872
  temperature: 280
  technology: Li-poly
</code></pre>
<p>其中 <code>scale</code> 代表最大电量，<code>level</code> 代表当前电量。上面的输出表示还剩下 44% 的电量。</p>
<h3 id="屏幕分辨率">屏幕分辨率</h3><p>命令：</p>
<pre><code class="lang-sh">adb shell wm size
</code></pre>
<p>输出示例：</p>
<pre><code class="lang-sh">Physical size: 1080x1920
</code></pre>
<p>该设备屏幕分辨率为 1080px * 1920px。</p>
<p>如果使用命令修改过，那输出可能是：</p>
<pre><code class="lang-sh">Physical size: 1080x1920
Override size: 480x1024
</code></pre>
<p>表明设备的屏幕分辨率原本是 1080px <em> 1920px，当前被修改为 480px </em> 1024px。</p>
<h3 id="屏幕密度">屏幕密度</h3><p>命令：</p>
<pre><code class="lang-sh">adb shell wm density
</code></pre>
<p>输出示例：</p>
<pre><code class="lang-sh">Physical density: 420
</code></pre>
<p>该设备屏幕密度为 420dpi。</p>
<p>如果使用命令修改过，那输出可能是：</p>
<pre><code class="lang-sh">Physical density: 480
Override density: 160
</code></pre>
<p>表明设备的屏幕密度原来是 480dpi，当前被修改为 160dpi。</p>
<h3 id="显示屏参数">显示屏参数</h3><p>命令：</p>
<pre><code class="lang-sh">adb shell dumpsys window displays
</code></pre>
<p>输出示例：</p>
<pre><code class="lang-sh">WINDOW MANAGER DISPLAY CONTENTS (dumpsys window displays)
  Display: mDisplayId=0
    init=1080x1920 420dpi cur=1080x1920 app=1080x1794 rng=1080x1017-1810x1731
    deferred=false layoutNeeded=false
</code></pre>
<p>其中 <code>mDisplayId</code> 为 显示屏编号，<code>init</code> 是初始分辨率和屏幕密度，<code>app</code> 的高度比 <code>init</code> 里的要小，表示屏幕底部有虚拟按键，高度为 1920 - 1794 = 126px 合 42dp。</p>
<h3 id="android_id">android_id</h3><p>命令：</p>
<pre><code class="lang-sh">adb shell settings get secure android_id
</code></pre>
<p>输出示例：</p>
<pre><code class="lang-sh">51b6be48bac8c569
</code></pre>
<h3 id="imei">IMEI</h3><p>在 Android 4.4 及以下版本可通过如下命令获取 IMEI：</p>
<pre><code class="lang-sh">adb shell dumpsys iphonesubinfo
</code></pre>
<p>输出示例：</p>
<pre><code class="lang-sh">Phone Subscriber Info:
  Phone Type = GSM
  Device ID = 860955027785041
</code></pre>
<p>其中的 <code>Device ID</code> 就是 IMEI。</p>
<p>而在 Android 5.0 及以上版本里这个命令输出为空，得通过其它方式获取了（需要 root 权限）：</p>
<pre><code class="lang-sh">adb shell
su
service call iphonesubinfo 1
</code></pre>
<p>输出示例：</p>
<pre><code class="lang-sh">Result: Parcel(
  0x00000000: 00000000 0000000f 00360038 00390030 &#39;........8.6.0.9.&#39;
  0x00000010: 00350035 00320030 00370037 00350038 &#39;5.5.0.2.7.7.8.5.&#39;
  0x00000020: 00340030 00000031                   &#39;0.4.1...        &#39;)
</code></pre>
<p>把里面的有效内容提取出来就是 IMEI 了，比如这里的是 <code>860955027785041</code>。</p>
<p>参考：<a href='http://stackoverflow.com/questions/27002663/adb-shell-dumpsys-iphonesubinfo-not-working-since-android-5-0-lollipop' title='' target='_blank'>adb shell dumpsys iphonesubinfo not working since Android 5.0 Lollipop</a></p>
<h3 id="android 系统版本">Android 系统版本</h3><p>命令：</p>
<pre><code class="lang-sh">adb shell getprop ro.build.version.release
</code></pre>
<p>输出示例：</p>
<pre><code class="lang-sh">5.0.2
</code></pre>
<h3 id="ip 地址">IP 地址</h3><p>每次想知道设备的 IP 地址的时候都得「设置」-「关于手机」-「状态信息」-「IP地址」很烦对不对？通过 adb 可以方便地查看。</p>
<p>命令：</p>
<pre><code class="lang-sh">adb shell ifconfig | grep Mask
</code></pre>
<p>输出示例：</p>
<pre><code class="lang-sh">inet addr:10.130.245.230  Mask:255.255.255.252
inet addr:127.0.0.1  Mask:255.0.0.0
</code></pre>
<p>那么 <code>10.130.245.230</code> 就是设备 IP 地址。</p>
<p>在有的设备上这个命令没有输出，如果设备连着 WiFi，可以使用如下命令来查看局域网 IP：</p>
<pre><code class="lang-sh">adb shell ifconfig wlan0
</code></pre>
<p>输出示例：</p>
<pre><code class="lang-sh">wlan0: ip 10.129.160.99 mask 255.255.240.0 flags [up broadcast running multicast]
</code></pre>
<p>或</p>
<pre><code class="lang-sh">wlan0     Link encap:UNSPEC
          inet addr:10.129.168.57  Bcast:10.129.175.255  Mask:255.255.240.0
          inet6 addr: fe80::66cc:2eff:fe68:b6b6/64 Scope: Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:496520 errors:0 dropped:0 overruns:0 frame:0
          TX packets:68215 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:3000
          RX bytes:116266821 TX bytes:8311736
</code></pre>
<p>如果以上命令仍然不能得到期望的信息，那可以试试以下命令（部分系统版本里可用）：</p>
<pre><code class="lang-sh">adb shell netcfg
</code></pre>
<p>输出示例：</p>
<pre><code class="lang-sh">wlan0    UP                               10.129.160.99/20  0x00001043 f8:a9:d0:17:42:4d
lo       UP                                   127.0.0.1/8   0x00000049 00:00:00:00:00:00
p2p0     UP                                     0.0.0.0/0   0x00001003 fa:a9:d0:17:42:4d
sit0     DOWN                                   0.0.0.0/0   0x00000080 00:00:00:00:00:00
rmnet0   DOWN                                   0.0.0.0/0   0x00000000 00:00:00:00:00:00
rmnet1   DOWN                                   0.0.0.0/0   0x00000000 00:00:00:00:00:00
rmnet3   DOWN                                   0.0.0.0/0   0x00000000 00:00:00:00:00:00
rmnet2   DOWN                                   0.0.0.0/0   0x00000000 00:00:00:00:00:00
rmnet4   DOWN                                   0.0.0.0/0   0x00000000 00:00:00:00:00:00
rmnet6   DOWN                                   0.0.0.0/0   0x00000000 00:00:00:00:00:00
rmnet5   DOWN                                   0.0.0.0/0   0x00000000 00:00:00:00:00:00
rmnet7   DOWN                                   0.0.0.0/0   0x00000000 00:00:00:00:00:00
rev_rmnet3 DOWN                                   0.0.0.0/0   0x00001002 4e:b7:e4:2e:17:58
rev_rmnet2 DOWN                                   0.0.0.0/0   0x00001002 4e:f0:c8:bf:7a:cf
rev_rmnet4 DOWN                                   0.0.0.0/0   0x00001002 a6:c0:3b:6b:c4:1f
rev_rmnet6 DOWN                                   0.0.0.0/0   0x00001002 66:bb:5d:64:2e:e9
rev_rmnet5 DOWN                                   0.0.0.0/0   0x00001002 0e:1b:eb:b9:23:a0
rev_rmnet7 DOWN                                   0.0.0.0/0   0x00001002 7a:d9:f6:81:40:5a
rev_rmnet8 DOWN                                   0.0.0.0/0   0x00001002 4e:e2:a9:bb:d0:1b
rev_rmnet0 DOWN                                   0.0.0.0/0   0x00001002 fe:65:d0:ca:82:a9
rev_rmnet1 DOWN                                   0.0.0.0/0   0x00001002 da:d8:e8:4f:2e:fe
</code></pre>
<p>可以看到网络连接名称、启用状态、IP 地址和 Mac 地址等信息。</p>
<h3 id="mac 地址">Mac 地址</h3><p>命令：</p>
<pre><code class="lang-sh">adb shell cat /sys/class/net/wlan0/address
</code></pre>
<p>输出示例：</p>
<pre><code class="lang-sh">f8:a9:d0:17:42:4d
</code></pre>
<p>这查看的是局域网 Mac 地址，移动网络或其它连接的信息可以通过前面的小节「IP 地址」里提到的 <code>adb shell netcfg</code> 命令来查看。</p>
<h3 id="cpu 信息">CPU 信息</h3><p>命令：</p>
<pre><code class="lang-sh">adb shell cat /proc/cpuinfo
</code></pre>
<p>输出示例：</p>
<pre><code class="lang-sh">Processor       : ARMv7 Processor rev 0 (v7l)
processor       : 0
BogoMIPS        : 38.40

processor       : 1
BogoMIPS        : 38.40

processor       : 2
BogoMIPS        : 38.40

processor       : 3
BogoMIPS        : 38.40

Features        : swp half thumb fastmult vfp edsp neon vfpv3 tls vfpv4 idiva idivt
CPU implementer : 0x51
CPU architecture: 7
CPU variant     : 0x2
CPU part        : 0x06f
CPU revision    : 0

Hardware        : Qualcomm MSM 8974 HAMMERHEAD (Flattened Device Tree)
Revision        : 000b
Serial          : 0000000000000000
</code></pre>
<p>这是 Nexus 5 的 CPU 信息，我们从输出里可以看到使用的硬件是 <code>Qualcomm MSM 8974</code>，processor 的编号是 0 到 3，所以它是四核的，采用的架构是 <code>ARMv7 Processor rev 0 (v71)</code>。</p>
<h3 id="内存信息">内存信息</h3><p>命令：</p>
<pre><code class="lang-sh">adb shell cat /proc/meminfo
</code></pre>
<p>输出示例：</p>
<pre><code class="lang-sh">MemTotal:        1027424 kB
MemFree:          486564 kB
Buffers:           15224 kB
Cached:            72464 kB
SwapCached:        24152 kB
Active:           110572 kB
Inactive:         259060 kB
Active(anon):      79176 kB
Inactive(anon):   207736 kB
Active(file):      31396 kB
Inactive(file):    51324 kB
Unevictable:        3948 kB
Mlocked:               0 kB
HighTotal:        409600 kB
HighFree:         132612 kB
LowTotal:         617824 kB
LowFree:          353952 kB
SwapTotal:        262140 kB
SwapFree:         207572 kB
Dirty:                 0 kB
Writeback:             0 kB
AnonPages:        265324 kB
Mapped:            47072 kB
Shmem:              1020 kB
Slab:              57372 kB
SReclaimable:       7692 kB
SUnreclaim:        49680 kB
KernelStack:        4512 kB
PageTables:         5912 kB
NFS_Unstable:          0 kB
Bounce:                0 kB
WritebackTmp:          0 kB
CommitLimit:      775852 kB
Committed_AS:   13520632 kB
VmallocTotal:     385024 kB
VmallocUsed:       61004 kB
VmallocChunk:     209668 kB
</code></pre>
<p>其中，<code>MemTotal</code> 就是设备的总内存，<code>MemFree</code> 是当前空闲内存。</p>
<h3 id="更多硬件与系统属性">更多硬件与系统属性</h3><p>设备的更多硬件与系统属性可以通过如下命令查看：</p>
<pre><code class="lang-sh">adb shell cat /system/build.prop
</code></pre>
<p>这会输出很多信息，包括前面几个小节提到的「型号」和「Android 系统版本」等。</p>
<p>输出里还包括一些其它有用的信息，它们也可通过 <code>adb shell getprop &lt;属性名&gt;</code> 命令单独查看，列举一部分属性如下：</p>
<div class='table-responsive'><table><thead><tr>
<th>属性名</th>
<th>含义</th>
</tr>
</thead><tr>
<td>ro.build.version.sdk</td>
<td>SDK 版本</td>
</tr>
<tr>
<td>ro.build.version.release</td>
<td>Android 系统版本</td>
</tr>
<tr>
<td>ro.build.version.security_patch</td>
<td>Android 安全补丁程序级别</td>
</tr>
<tr>
<td>ro.product.model</td>
<td>型号</td>
</tr>
<tr>
<td>ro.product.brand</td>
<td>品牌</td>
</tr>
<tr>
<td>ro.product.name</td>
<td>设备名</td>
</tr>
<tr>
<td>ro.product.board</td>
<td>处理器型号</td>
</tr>
<tr>
<td>ro.product.cpu.abilist</td>
<td>CPU 支持的 abi 列表[<em>节注一</em>]</td>
</tr>
<tr>
<td>persist.sys.isUsbOtgEnabled</td>
<td>是否支持 OTG</td>
</tr>
<tr>
<td>dalvik.vm.heapsize</td>
<td>每个应用程序的内存上限</td>
</tr>
<tr>
<td>ro.sf.lcd_density</td>
<td>屏幕密度</td>
</tr>
</table></div><p><em>节注一：</em></p>
<p>一些小厂定制的 ROM 可能修改过 CPU 支持的 abi 列表的属性名，如果用 <code>ro.product.cpu.abilist</code> 属性名查找不到，可以这样试试：</p>
<pre><code class="lang-sh">adb shell cat /system/build.prop | grep ro.product.cpu.abi
</code></pre>
<p>示例输出：</p>
<pre><code class="lang-sh">ro.product.cpu.abi=armeabi-v7a
ro.product.cpu.abi2=armeabi
</code></pre>
<h2 id="修改设置">修改设置</h2><p><strong>注：</strong> 修改设置之后，运行恢复命令有可能显示仍然不太正常，可以运行 <code>adb reboot</code> 重启设备，或手动重启。</p>
<p>修改设置的原理主要是通过 settings 命令修改 /data/data/com.android.providers.settings/databases/settings.db 里存放的设置值。</p>
<h3 id="分辨率">分辨率</h3><p>命令：</p>
<pre><code class="lang-sh">adb shell wm size 480x1024
</code></pre>
<p>表示将分辨率修改为 480px * 1024px。</p>
<p>恢复原分辨率命令：</p>
<pre><code class="lang-sh">adb shell wm size reset
</code></pre>
<h3 id="屏幕密度">屏幕密度</h3><p>命令：</p>
<pre><code class="lang-sh">adb shell wm density 160
</code></pre>
<p>表示将屏幕密度修改为 160dpi。</p>
<p>恢复原屏幕密度命令：</p>
<pre><code class="lang-sh">adb shell wm density reset
</code></pre>
<h3 id="显示区域">显示区域</h3><p>命令：</p>
<pre><code class="lang-sh">adb shell wm overscan 0,0,0,200
</code></pre>
<p>四个数字分别表示距离左、上、右、下边缘的留白像素，以上命令表示将屏幕底部 200px 留白。</p>
<p>恢复原显示区域命令：</p>
<pre><code class="lang-sh">adb shell wm overscan reset
</code></pre>
<h3 id="关闭 usb 调试模式">关闭 USB 调试模式</h3><p>命令：</p>
<pre><code class="lang-sh">adb shell settings put global adb_enabled 0
</code></pre>
<p>恢复：</p>
<p>用命令恢复不了了，毕竟关闭了 USB 调试 adb 就连接不上 Android 设备了。</p>
<p>去设备上手动恢复吧：「设置」-「开发者选项」-「Android 调试」。</p>
<h3 id="允许/禁止访问非 sdk api">允许/禁止访问非 SDK API</h3><p>允许访问非 SDK API：</p>
<pre><code class="lang-sh">adb shell settings put global hidden_api_policy_pre_p_apps 1
adb shell settings put global hidden_api_policy_p_apps 1
</code></pre>
<p>禁止访问非 SDK API：</p>
<pre><code class="lang-sh">adb shell settings delete global hidden_api_policy_pre_p_apps
adb shell settings delete global hidden_api_policy_p_apps
</code></pre>
<p>不需要设备获得 Root 权限。</p>
<p>命令最后的数字的含义：</p>
<div class='table-responsive'><table><thead><tr>
<th>值</th>
<th>含义</th>
</tr>
</thead><tr>
<td>0</td>
<td>禁止检测非 SDK 接口的调用。该情况下，日志记录功能被禁用，并且令 strict mode API，即 detectNonSdkApiUsage() 无效。不推荐。</td>
</tr>
<tr>
<td>1</td>
<td>仅警告——允许访问所有非 SDK 接口，但保留日志中的警告信息，可继续使用 strick mode API。</td>
</tr>
<tr>
<td>2</td>
<td>禁止调用深灰名单和黑名单中的接口。</td>
</tr>
<tr>
<td>3</td>
<td>禁止调用黑名单中的接口，但允许调用深灰名单中的接口。</td>
</tr>
</table></div><h3 id="状态栏和导航栏的显示隐藏">状态栏和导航栏的显示隐藏</h3><p>本节所说的相关设置对应 Cyanogenmod 里的「扩展桌面」。</p>
<p>命令：</p>
<pre><code class="lang-sh">adb shell settings put global policy_control &lt;key-values&gt;
</code></pre>
<p><code>&lt;key-values&gt;</code> 可由如下几种键及其对应的值组成，格式为 <code>&lt;key1&gt;=&lt;value1&gt;:&lt;key2&gt;=&lt;value2&gt;</code>。</p>
<div class='table-responsive'><table><thead><tr>
<th>key</th>
<th>含义</th>
</tr>
</thead><tr>
<td>immersive.full</td>
<td>同时隐藏</td>
</tr>
<tr>
<td>immersive.status</td>
<td>隐藏状态栏</td>
</tr>
<tr>
<td>immersive.navigation</td>
<td>隐藏导航栏</td>
</tr>
<tr>
<td>immersive.preconfirms</td>
<td>?</td>
</tr>
</table></div><p>这些键对应的值可则如下值用逗号组合：</p>
<div class='table-responsive'><table><thead><tr>
<th>value</th>
<th>含义</th>
</tr>
</thead><tr>
<td><code>apps</code></td>
<td>所有应用</td>
</tr>
<tr>
<td><code>*</code></td>
<td>所有界面</td>
</tr>
<tr>
<td><code>packagename</code></td>
<td>指定应用</td>
</tr>
<tr>
<td><code>-packagename</code></td>
<td>排除指定应用</td>
</tr>
</table></div><p>例如：</p>
<pre><code class="lang-sh">adb shell settings put global policy_control immersive.full=*
</code></pre>
<p>表示设置在所有界面下都同时隐藏状态栏和导航栏。</p>
<pre><code class="lang-sh">adb shell settings put global policy_control immersive.status=com.package1,com.package2:immersive.navigation=apps,-com.package3
</code></pre>
<p>表示设置在包名为 <code>com.package1</code> 和 <code>com.package2</code> 的应用里隐藏状态栏，在除了包名为 <code>com.package3</code> 的所有应用里隐藏导航栏。</p>
<h2 id="实用功能">实用功能</h2><h3 id="屏幕截图">屏幕截图</h3><p>截图保存到电脑：</p>
<pre><code class="lang-sh">adb exec-out screencap -p &gt; sc.png
</code></pre>
<p>如果 adb 版本较老，无法使用 <code>exec-out</code> 命令，这时候建议更新 adb 版本。无法更新的话可以使用以下麻烦点的办法：</p>
<p>先截图保存到设备里：</p>
<pre><code class="lang-sh">adb shell screencap -p /sdcard/sc.png
</code></pre>
<p>然后将 png 文件导出到电脑：</p>
<pre><code class="lang-sh">adb pull /sdcard/sc.png
</code></pre>
<p>可以使用 <code>adb shell screencap -h</code> 查看 <code>screencap</code> 命令的帮助信息，下面是两个有意义的参数及含义：</p>
<div class='table-responsive'><table><thead><tr>
<th>参数</th>
<th>含义</th>
</tr>
</thead><tr>
<td>-p</td>
<td>指定保存文件为 png 格式</td>
</tr>
<tr>
<td>-d display-id</td>
<td>指定截图的显示屏编号（有多显示屏的情况下）</td>
</tr>
</table></div><p>实测如果指定文件名以 <code>.png</code> 结尾时可以省略 -p 参数；否则需要使用 -p 参数。如果不指定文件名，截图文件的内容将直接输出到 stdout。</p>
<p>另外一种一行命令截图并保存到电脑的方法：</p>
<p><em>Linux 和 Windows</em></p>
<pre><code class="lang-sh">adb shell screencap -p | sed &quot;s/\r$//&quot; &gt; sc.png
</code></pre>
<p><em>Mac OS X</em></p>
<pre><code class="lang-sh">adb shell screencap -p | gsed &quot;s/\r$//&quot; &gt; sc.png
</code></pre>
<p>这个方法需要用到 gnu sed 命令，在 Linux 下直接就有，在 Windows 下 Git 安装目录的 bin 文件夹下也有。如果确实找不到该命令，可以下载 <a href='http://gnuwin32.sourceforge.net/packages/sed.htm' title='' target='_blank'>sed for Windows</a> 并将 sed.exe 所在文件夹添加到 PATH 环境变量里。</p>
<p>而在 Mac 下使用系统自带的 sed 命令会报错：</p>
<pre><code class="lang-sh">sed: RE error: illegal byte sequence
</code></pre>
<p>需要安装 gnu-sed，然后使用 gsed 命令：</p>
<pre><code class="lang-sh">brew install gnu-sed
</code></pre>
<h3 id="录制屏幕">录制屏幕</h3><p>录制屏幕以 mp4 格式保存到 /sdcard：</p>
<pre><code class="lang-sh">adb shell screenrecord /sdcard/filename.mp4
</code></pre>
<p>需要停止时按 <kbd>Ctrl-C</kbd>，默认录制时间和最长录制时间都是 180 秒。</p>
<p>如果需要导出到电脑：</p>
<pre><code class="lang-sh">adb pull /sdcard/filename.mp4
</code></pre>
<p>可以使用 <code>adb shell screenrecord --help</code> 查看 <code>screenrecord</code> 命令的帮助信息，下面是常见参数及含义：</p>
<div class='table-responsive'><table><thead><tr>
<th>参数</th>
<th>含义</th>
</tr>
</thead><tr>
<td>--size WIDTHxHEIGHT</td>
<td>视频的尺寸，比如 <code>1280x720</code>，默认是屏幕分辨率。</td>
</tr>
<tr>
<td>--bit-rate RATE</td>
<td>视频的比特率，默认是 4Mbps。</td>
</tr>
<tr>
<td>--time-limit TIME</td>
<td>录制时长，单位秒。</td>
</tr>
<tr>
<td>--verbose</td>
<td>输出更多信息。</td>
</tr>
</table></div><h3 id="重新挂载 system 分区为可写">重新挂载 system 分区为可写</h3><p><strong>注：需要 root 权限。</strong></p>
<p>/system 分区默认挂载为只读，但有些操作比如给 Android 系统添加命令、删除自带应用等需要对 /system 进行写操作，所以需要重新挂载它为可读写。</p>
<p>步骤：</p>
<ol>
<li><p>进入 shell 并切换到 root 用户权限。</p>
<p>命令：</p>
<pre><code class="lang-sh">adb shell
su
</code></pre>
</li><li><p>查看当前分区挂载情况。</p>
<p>命令：</p>
<pre><code class="lang-sh">mount
</code></pre>
<p>输出示例：</p>
<pre><code class="lang-sh">rootfs / rootfs ro,relatime 0 0
tmpfs /dev tmpfs rw,seclabel,nosuid,relatime,mode=755 0 0
devpts /dev/pts devpts rw,seclabel,relatime,mode=600 0 0
proc /proc proc rw,relatime 0 0
sysfs /sys sysfs rw,seclabel,relatime 0 0
selinuxfs /sys/fs/selinux selinuxfs rw,relatime 0 0
debugfs /sys/kernel/debug debugfs rw,relatime 0 0
none /var tmpfs rw,seclabel,relatime,mode=770,gid=1000 0 0
none /acct cgroup rw,relatime,cpuacct 0 0
none /sys/fs/cgroup tmpfs rw,seclabel,relatime,mode=750,gid=1000 0 0
none /sys/fs/cgroup/memory cgroup rw,relatime,memory 0 0
tmpfs /mnt/asec tmpfs rw,seclabel,relatime,mode=755,gid=1000 0 0
tmpfs /mnt/obb tmpfs rw,seclabel,relatime,mode=755,gid=1000 0 0
none /dev/memcg cgroup rw,relatime,memory 0 0
none /dev/cpuctl cgroup rw,relatime,cpu 0 0
none /sys/fs/cgroup tmpfs rw,seclabel,relatime,mode=750,gid=1000 0 0
none /sys/fs/cgroup/memory cgroup rw,relatime,memory 0 0
none /sys/fs/cgroup/freezer cgroup rw,relatime,freezer 0 0
/dev/block/platform/msm_sdcc.1/by-name/system /system ext4 ro,seclabel,relatime,data=ordered 0 0
/dev/block/platform/msm_sdcc.1/by-name/userdata /data ext4 rw,seclabel,nosuid,nodev,relatime,noauto_da_alloc,data=ordered 0 0
/dev/block/platform/msm_sdcc.1/by-name/cache /cache ext4 rw,seclabel,nosuid,nodev,relatime,data=ordered 0 0
/dev/block/platform/msm_sdcc.1/by-name/persist /persist ext4 rw,seclabel,nosuid,nodev,relatime,data=ordered 0 0
/dev/block/platform/msm_sdcc.1/by-name/modem /firmware vfat ro,context=u:object_r:firmware_file:s0,relatime,uid=1000,gid=1000,fmask=0337,dmask=0227,codepage=cp437,iocharset=iso8859-1,shortname=lower,errors=remount-ro 0 0
/dev/fuse /mnt/shell/emulated fuse rw,nosuid,nodev,relatime,user_id=1023,group_id=1023,default_permissions,allow_other 0 0
/dev/fuse /mnt/shell/emulated/0 fuse rw,nosuid,nodev,relatime,user_id=1023,group_id=1023,default_permissions,allow_other 0 0
</code></pre>
<p>找到其中我们关注的带 /system 的那一行：</p>
<pre><code class="lang-sh">/dev/block/platform/msm_sdcc.1/by-name/system /system ext4 ro,seclabel,relatime,data=ordered 0 0
</code></pre>
</li><li><p>重新挂载。</p>
<p>命令：</p>
<pre><code class="lang-sh">mount -o remount,rw -t yaffs2 /dev/block/platform/msm_sdcc.1/by-name/system /system
</code></pre>
<p>这里的 <code>/dev/block/platform/msm_sdcc.1/by-name/system</code> 就是我们从上一步的输出里得到的文件路径。</p>
</li></ol>
<p>如果输出没有提示错误的话，操作就成功了，可以对 /system 下的文件为所欲为了。</p>
<h3 id="查看连接过的 wifi 密码">查看连接过的 WiFi 密码</h3><p><strong>注：需要 root 权限。</strong></p>
<p>命令：</p>
<pre><code class="lang-sh">adb shell
su
cat /data/misc/wifi/*.conf
</code></pre>
<p>输出示例：</p>
<pre><code class="lang-sh">network={
    ssid=&quot;TP-LINK_9DFC&quot;
    scan_ssid=1
    psk=&quot;123456789&quot;
    key_mgmt=WPA-PSK
    group=CCMP TKIP
    auth_alg=OPEN
    sim_num=1
    priority=13893
}

network={
    ssid=&quot;TP-LINK_F11E&quot;
    psk=&quot;987654321&quot;
    key_mgmt=WPA-PSK
    sim_num=1
    priority=17293
}
</code></pre>
<p><code>ssid</code> 即为我们在 WLAN 设置里看到的名称，<code>psk</code> 为密码，<code>key_mgmt</code> 为安全加密方式。</p>
<h3 id="设置系统日期和时间">设置系统日期和时间</h3><p><strong>注：需要 root 权限。</strong></p>
<p>命令：</p>
<pre><code class="lang-sh">adb shell
su
date -s 20160823.131500
</code></pre>
<p>表示将系统日期和时间更改为 2016 年 08 月 23 日 13 点 15 分 00 秒。</p>
<h3 id="重启手机">重启手机</h3><p>命令：</p>
<pre><code class="lang-sh">adb reboot
</code></pre>
<h3 id="检测设备是否已 root">检测设备是否已 root</h3><p>命令：</p>
<pre><code class="lang-sh">adb shell
su
</code></pre>
<p>此时命令行提示符是 <code>$</code> 则表示没有 root 权限，是 <code>#</code> 则表示已 root。</p>
<h3 id="使用 monkey 进行压力测试">使用 Monkey 进行压力测试</h3><p>Monkey 可以生成伪随机用户事件来模拟单击、触摸、手势等操作，可以对正在开发中的程序进行随机压力测试。</p>
<p>简单用法：</p>
<pre><code class="lang-sh">adb shell monkey -p &lt;packagename&gt; -v 500
</code></pre>
<p>表示向 <code>&lt;packagename&gt;</code> 指定的应用程序发送 500 个伪随机事件。</p>
<p>Monkey 的详细用法参考 <a href='https://developer.android.com/studio/test/monkey.html' title='' target='_blank'>官方文档</a>。</p>
<h3 id="开启/关闭 wifi">开启/关闭 WiFi</h3><p><strong>注：需要 root 权限。</strong></p>
<p>有时需要控制设备的 WiFi 状态，可以用以下指令完成。</p>
<p>开启 WiFi：</p>
<pre><code class="lang-sh">adb root
adb shell svc wifi enable
</code></pre>
<p>关闭 WiFi：</p>
<pre><code class="lang-sh">adb root
adb shell svc wifi disable
</code></pre>
<p>若执行成功，输出为空；若未取得 root 权限执行此命令，将执行失败，输出 <code>Killed</code>。</p>
<h2 id="刷机相关命令">刷机相关命令</h2><h3 id="重启到 recovery 模式">重启到 Recovery 模式</h3><p>命令：</p>
<pre><code class="lang-sh">adb reboot recovery
</code></pre>
<h3 id="从 recovery 重启到 android">从 Recovery 重启到 Android</h3><p>命令：</p>
<pre><code class="lang-sh">adb reboot
</code></pre>
<h3 id="重启到 fastboot 模式">重启到 Fastboot 模式</h3><p>命令：</p>
<pre><code class="lang-sh">adb reboot bootloader
</code></pre>
<h3 id="通过 sideload 更新系统">通过 sideload 更新系统</h3><p>如果我们下载了 Android 设备对应的系统更新包到电脑上，那么也可以通过 adb 来完成更新。</p>
<p>以 Recovery 模式下更新为例：</p>
<ol>
<li><p>重启到 Recovery 模式。</p>
<p>命令：</p>
<pre><code class="lang-sh">adb reboot recovery
</code></pre>
</li><li><p>在设备的 Recovery 界面上操作进入 <code>Apply update</code>-<code>Apply from ADB</code>。</p>
<p>注：不同的 Recovery 菜单可能与此有差异，有的是一级菜单就有 <code>Apply update from ADB</code>。</p>
</li><li><p>通过 adb 上传和更新系统。</p>
<p>命令：</p>
<pre><code class="lang-sh">adb sideload &lt;path-to-update.zip&gt;
</code></pre>
</li></ol>
<h2 id="安全相关命令">安全相关命令</h2><h3 id="启用/禁用 selinux">启用/禁用 SELinux</h3><p>启用 SELinux</p>
<pre><code class="lang-sh">adb root
adb shell setenforce 1
</code></pre>
<p>禁用 SELinux</p>
<pre><code class="lang-sh">adb root
adb shell setenforce 0
</code></pre>
<h3 id="启用/禁用 dm_verity">启用/禁用 dm_verity</h3><p>启用 dm_verity</p>
<pre><code class="lang-sh">adb root
adb enable-verity
</code></pre>
<p>禁用 dm_verity</p>
<pre><code class="lang-sh">adb root
adb disable-verity
</code></pre>
<h2 id="更多 adb shell 命令">更多 adb shell 命令</h2><p>Android 系统是基于 Linux 内核的，所以 Linux 里的很多命令在 Android 里也有相同或类似的实现，在 <code>adb shell</code> 里可以调用。本文档前面的部分内容已经用到了 <code>adb shell</code> 命令。</p>
<h3 id="查看进程">查看进程</h3><p>命令：</p>
<pre><code class="lang-sh">adb shell ps
</code></pre>
<p>输出示例：</p>
<pre><code class="lang-sh">USER     PID   PPID  VSIZE  RSS     WCHAN    PC        NAME
root      1     0     8904   788   ffffffff 00000000 S /init
root      2     0     0      0     ffffffff 00000000 S kthreadd
...
u0_a71    7779  5926  1538748 48896 ffffffff 00000000 S com.sohu.inputmethod.sogou:classic
u0_a58    7963  5926  1561916 59568 ffffffff 00000000 S org.mazhuang.boottimemeasure
...
shell     8750  217   10640  740   00000000 b6f28340 R ps
</code></pre>
<p>各列含义：</p>
<div class='table-responsive'><table><thead><tr>
<th>列名</th>
<th>含义</th>
</tr>
</thead><tr>
<td>USER</td>
<td>所属用户</td>
</tr>
<tr>
<td>PID</td>
<td>进程 ID</td>
</tr>
<tr>
<td>PPID</td>
<td>父进程 ID</td>
</tr>
<tr>
<td>NAME</td>
<td>进程名</td>
</tr>
</table></div><h3 id="查看实时资源占用情况">查看实时资源占用情况</h3><p>命令：</p>
<pre><code class="lang-sh">adb shell top
</code></pre>
<p>输出示例：</p>
<pre><code class="lang-sh">User 0%, System 6%, IOW 0%, IRQ 0%
User 3 + Nice 0 + Sys 21 + Idle 280 + IOW 0 + IRQ 0 + SIRQ 3 = 307

  PID PR CPU% S  #THR     VSS     RSS PCY UID      Name
 8763  0   3% R     1  10640K   1064K  fg shell    top
  131  0   3% S     1      0K      0K  fg root     dhd_dpc
 6144  0   0% S   115 1682004K 115916K  fg system   system_server
  132  0   0% S     1      0K      0K  fg root     dhd_rxf
 1731  0   0% S     6  20288K    788K  fg root     /system/bin/mpdecision
  217  0   0% S     6  18008K    356K  fg shell    /sbin/adbd
 ...
 7779  2   0% S    19 1538748K  48896K  bg u0_a71   com.sohu.inputmethod.sogou:classic
 7963  0   0% S    18 1561916K  59568K  fg u0_a58   org.mazhuang.boottimemeasure
 ...
</code></pre>
<p>各列含义：</p>
<div class='table-responsive'><table><thead><tr>
<th>列名</th>
<th>含义</th>
</tr>
</thead><tr>
<td>PID</td>
<td>进程 ID</td>
</tr>
<tr>
<td>PR</td>
<td>优先级</td>
</tr>
<tr>
<td>CPU%</td>
<td>当前瞬间占用 CPU 百分比</td>
</tr>
<tr>
<td>S</td>
<td>进程状态（R=运行，S=睡眠，T=跟踪/停止，Z=僵尸进程）</td>
</tr>
<tr>
<td>#THR</td>
<td>线程数</td>
</tr>
<tr>
<td>VSS</td>
<td>Virtual Set Size 虚拟耗用内存（包含共享库占用的内存）</td>
</tr>
<tr>
<td>RSS</td>
<td>Resident Set Size 实际使用物理内存（包含共享库占用的内存）</td>
</tr>
<tr>
<td>PCY</td>
<td>调度策略优先级，SP_BACKGROUND/SPFOREGROUND</td>
</tr>
<tr>
<td>UID</td>
<td>进程所有者的用户 ID</td>
</tr>
<tr>
<td>NAME</td>
<td>进程名</td>
</tr>
</table></div><p><code>top</code> 命令还支持一些命令行参数，详细用法如下：</p>
<pre><code class="lang-sh">Usage: top [ -m max_procs ] [ -n iterations ] [ -d delay ] [ -s sort_column ] [ -t ] [ -h ]
    -m num  最多显示多少个进程
    -n num  刷新多少次后退出
    -d num  刷新时间间隔（单位秒，默认值 5）
    -s col  按某列排序（可用 col 值：cpu, vss, rss, thr）
    -t      显示线程信息
    -h      显示帮助文档
</code></pre>
<h3 id="查看进程 uid">查看进程 UID</h3><p>有两种方案：</p>
<ol>
<li><p><code>adb shell dumpsys package &lt;packagename&gt; | grep userId=</code></p>
<p>如：</p>
<pre><code class="lang-sh">$ adb shell dumpsys package org.mazhuang.guanggoo | grep userId=
   userId=10394
</code></pre>
</li><li><p>通过 ps 命令找到对应进程的 pid 之后 <code>adb shell cat /proc/&lt;pid&gt;/status | grep Uid</code></p>
<p>如：</p>
<pre><code class="lang-sh">$ adb shell
gemini:/ $ ps | grep org.mazhuang.guanggoo
u0_a394   28635 770   1795812 78736 SyS_epoll_ 0000000000 S org.mazhuang.guanggoo
gemini:/ $ cat /proc/28635/status | grep Uid
Uid:    10394   10394   10394   10394
gemini:/ $
</code></pre>
</li></ol>
<h3 id="其它">其它</h3><p>如下是其它常用命令的简单描述，前文已经专门讲过的命令不再额外说明：</p>
<div class='table-responsive'><table><thead><tr>
<th>命令</th>
<th>功能</th>
</tr>
</thead><tr>
<td>cat</td>
<td>显示文件内容</td>
</tr>
<tr>
<td>cd</td>
<td>切换目录</td>
</tr>
<tr>
<td>chmod</td>
<td>改变文件的存取模式/访问权限</td>
</tr>
<tr>
<td>df</td>
<td>查看磁盘空间使用情况</td>
</tr>
<tr>
<td>grep</td>
<td>过滤输出</td>
</tr>
<tr>
<td>kill</td>
<td>杀死指定 PID 的进程</td>
</tr>
<tr>
<td>ls</td>
<td>列举目录内容</td>
</tr>
<tr>
<td>mount</td>
<td>挂载目录的查看和管理</td>
</tr>
<tr>
<td>mv</td>
<td>移动或重命名文件</td>
</tr>
<tr>
<td>ps</td>
<td>查看正在运行的进程</td>
</tr>
<tr>
<td>rm</td>
<td>删除文件</td>
</tr>
<tr>
<td>top</td>
<td>查看进程的资源占用情况</td>
</tr>
</table></div><h2 id="常见问题">常见问题</h2><h3 id="启动 adb server 失败">启动 adb server 失败</h3><p><strong>出错提示</strong></p>
<pre><code class="lang-sh">error: protocol fault (couldn&#39;t read status): No error
</code></pre>
<p><strong>可能原因</strong></p>
<p>adb server 进程想使用的 5037 端口被占用。</p>
<p><strong>解决方案</strong></p>
<p>找到占用 5037 端口的进程，然后终止它。以 Windows 下为例：</p>
<pre><code class="lang-sh">netstat -ano | findstr LISTENING

...
TCP    0.0.0.0:5037           0.0.0.0:0              LISTENING       1548
...
</code></pre>
<p>这里 1548 即为进程 ID，用命令结束该进程：</p>
<pre><code class="lang-sh">taskkill /PID 1548
</code></pre>
<p>然后再启动 adb 就没问题了。</p>
<h3 id="com-android-ddmlib-adbcommandrejectedexception">com.android.ddmlib.AdbCommandRejectedException</h3><p>在 Android Studio 里新建一个模拟器，但是用 adb 一直连接不上，提示：</p>
<pre><code>com.android.ddmlib.AdbCommandRejectedException: device unauthorized.
This adb server&#39;s $ADB_VENDOR_KEYS is not set
Try &#39;adb kill-server&#39; if that seems wrong.
Otherwise check for a confirmation dialog on your device.
</code></pre><p>在手机上安装一个终端然后执行 su 提示没有该命令，这不正常。</p>
<p>于是删除该模拟器后重新下载安装一次，这次就正常了。</p>
<h2 id="adb 的非官方实现">adb 的非官方实现</h2><ul>
<li><a href='https://github.com/facebook/fb-adb' title='' target='_blank'>fb-adb</a> - A better shell for Android devices (for Mac).</li></ul>
<h2 id="相关命令">相关命令</h2><ul>
<li><a href='./related/aapt.md' title='' target='_blank'>aapt</a></li><li><a href='./related/am.md' title='' target='_blank'>am</a></li><li><a href='./related/dumpsys.md' title='' target='_blank'>dumsys</a></li><li><a href='./related/pm.md' title='' target='_blank'>pm</a></li><li><a href='./related/uiautomator.md' title='' target='_blank'>uiautomator</a></li></ul>
<h2 id="致谢">致谢</h2><p>感谢朋友们无私的分享与补充（排名不分先后）。</p>
<p><a href='https://github.com/zxning' title='' target='_blank'>zxning</a>，<a href='https://github.com/linhua55' title='' target='_blank'>linhua55</a>，<a href='https://github.com/codeskyblue' title='' target='_blank'>codeskyblue</a>，<a href='https://github.com/seasonyuu' title='' target='_blank'>seasonyuu</a>，<a href='https://github.com/fan123199' title='' target='_blank'>fan123199</a>，<a href='https://github.com/zhEdward' title='' target='_blank'>zhEdward</a>，<a href='https://github.com/0x8BADFOOD' title='' target='_blank'>0x8BADFOOD</a>，<a href='https://github.com/keith666666' title='' target='_blank'>keith666666</a>，<a href='https://github.com/shawnlinboy' title='' target='_blank'>shawnlinboy</a>，<a href='https://github.com/s-xq' title='' target='_blank'>s-xq</a>，
<a href='https://github.com/lucky9322' title='' target='_blank'>lucky9322</a>。</p>
<h2 id="参考链接">参考链接</h2><ul>
<li><a href='https://developer.android.com/studio/command-line/adb.html' title='' target='_blank'>Android Debug Bridge</a></li><li><a href='https://developer.android.com/studio/command-line/shell.html' title='' target='_blank'>ADB Shell Commands</a></li><li><a href='https://developer.android.com/studio/command-line/logcat.html' title='' target='_blank'>logcat Command-line Tool</a></li><li><a href='http://zmywly8866.github.io/2015/01/24/all-adb-command.html' title='' target='_blank'>Android ADB命令大全</a></li><li><a href='https://github.com/ZQiang94/StudyRecords/blob/master/other/src/main/java/com/other/adb%20%E5%91%BD%E4%BB%A4%E8%A1%8C%E7%9A%84%E4%BD%BF%E7%94%A8%E8%AE%B0%E5%BD%95.md' title='' target='_blank'>adb 命令行的使用记录</a></li><li><a href='http://www.jianshu.com/p/860bc2bf1a6a' title='' target='_blank'>Android ADB命令大全(通过ADB命令查看wifi密码、MAC地址、设备信息、操作文件、查看文件、日志信息、卸载、启动和安装APK等)</a></li><li><a href='http://yifeiyuan.me/2016/06/30/ADB%E5%91%BD%E4%BB%A4%E6%95%B4%E7%90%86/' title='' target='_blank'>那些做Android开发必须知道的ADB命令</a></li><li><a href='http://blog.csdn.net/kittyboy0001/article/details/38562515' title='' target='_blank'>adb shell top</a></li><li><a href='http://cabins.github.io/2016/03/25/UseAdbLikeAPro-2/' title='' target='_blank'>像高手一样使用ADB命令行（2）</a></li></ul>

                                        </div>
                                    </article>
                                    <div class="article-end"
                                        data-v-5762947c data-v-125fc212>
                                        
                                    </div>
                                    <div
    data-v-738d100d
    data-v-125fc212
    data-jj-helper="comment-container"
    class="post-comment" data-v-5762947c>
    <link rel="stylesheet" href="../css/gitalk.css">
    
    <div class="message-card add-top" id="comment-card">
	<div class="gitalk_container">
		<div id="gitalk-container"></div>
		<link rel="stylesheet" href="https://unpkg.com/gitalk@latest/dist/gitalk.css"
			async>
		<script src="https://unpkg.com/gitalk@latest/dist/gitalk.min.js" async></script>
		<script type="text/javascript">
			let initGitalk = ()=> {
				if (typeof(Gitalk) == 'undefined') {
                    setTimeout(initGitalk, 20);
                    return;
                } 
				let gitalk = new Gitalk({
				clientID: "7e48ff7dd55f15c9f051",
				clientSecret: "a5a35f0a17ee770eabd97358255ec6839486a7dd",
				repo: "gitalk.echo.engineer",
				owner: "Pluckypan",
				admin: "Pluckypan",
				distractionFreeMode: "true",
				labels: ['post']
			});
				gitalk.render('gitalk-container');
			}
			$(()=>{
				initGitalk();
			})
		</script>
	</div>
</div>
    
</div>
                                </div>
                                <div id="sidebar-container"
                                    class="sidebar article-sidebar"
                                    data-v-5a150454 data-v-125fc212
                                    data-v-5762947c>
                                    <div
    data-v-7e7e812a
    data-v-05741537
    data-v-5a150454
    class="sidebar-block wechat-sidebar-block pure wechat-ad">
    <div data-v-05741537 data-v-7e7e812a class="ad-container">
        <div data-v-05741537 data-v-7e7e812a class="text-container">
            <div data-v-05741537 data-v-7e7e812a class="text-description">
                找对属于你的技术圈子
            </div>

            <div data-v-05741537 data-v-7e7e812a class="text-reply">
                回复「进群」加入官方微信群
            </div>
        </div>
        <img
            data-v-05741537
            data-v-7e7e812a
            src="../assets/qrcode.png"
            loading="lazy"
            class="qr-code" />
    </div>
</div>

                                    <div class data-v-5a150454 id="jj_post_nav">
    <nav
        class="article-catalog catalog-block"
        data-v-6239701c
        data-v-16ed86c3
        data-v-5a150454>
        <div class="catalog-title" data-v-6239701c>
            <div data-v-6239701c>目录</div>
            <div class="direction" data-v-6239701c>
                <div class="word" data-v-6239701c>收起</div>
                <svg
                    id="icon_expand_toogle"
                    width="12"
                    height="12"
                    viewBox="0 0 12 12"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                    class="icon-rotate"
                    data-v-6239701c>
                    <g
                        id="&amp;#229;&amp;#177;&amp;#149;&amp;#229;&amp;#188;&amp;#128;"
                        data-v-6239701c>
                        <path
                            id="&amp;#232;&amp;#183;&amp;#175;&amp;#229;&amp;#190;&amp;#132;"
                            fill-rule="evenodd"
                            clip-rule="evenodd"
                            d="M5.99854 7.93206L10.0644 3.86619C10.162 3.76856 10.3203 3.76856 10.418 3.86619L10.7715 4.21975C10.8691 4.31738 10.8691 4.47567 10.7715 4.5733L6.35209 8.99272C6.15683 9.18798 5.84025 9.18798 5.64498 8.99272L1.22557 4.5733C1.12794 4.47567 1.12794 4.31738 1.22557 4.21975L1.57912 3.86619C1.67675 3.76856 1.83504 3.76856 1.93267 3.86619L5.99854 7.93206Z"
                            fill="#8A919F"
                            data-v-6239701c></path>
                    </g>
                </svg>
            </div>
        </div>
        <div class="catalog-body unfold" data-v-6239701c>
            <ul class="catalog-list" style="margin-top: 0px" data-v-6239701c>
                
                
                <li class="item d1" data-v-6239701c>
                    <div class="a-container">
                        <span
                            target_id="#基本用法"
                            class="catalog-aTag d1-aTag-title">
                            基本用法
                        </span>
                    </div>
                </li>
                
                <li class="item d1" data-v-6239701c>
                    <div class="a-container">
                        <span
                            target_id="#设备连接管理"
                            class="catalog-aTag d1-aTag-title">
                            设备连接管理
                        </span>
                    </div>
                </li>
                
                <li class="item d1" data-v-6239701c>
                    <div class="a-container">
                        <span
                            target_id="#应用管理"
                            class="catalog-aTag d1-aTag-title">
                            应用管理
                        </span>
                    </div>
                </li>
                
                <li class="item d1" data-v-6239701c>
                    <div class="a-container">
                        <span
                            target_id="#与应用交互"
                            class="catalog-aTag d1-aTag-title">
                            与应用交互
                        </span>
                    </div>
                </li>
                
                <li class="item d1" data-v-6239701c>
                    <div class="a-container">
                        <span
                            target_id="#文件管理"
                            class="catalog-aTag d1-aTag-title">
                            文件管理
                        </span>
                    </div>
                </li>
                
                <li class="item d1" data-v-6239701c>
                    <div class="a-container">
                        <span
                            target_id="#模拟按键/输入"
                            class="catalog-aTag d1-aTag-title">
                            模拟按键/输入
                        </span>
                    </div>
                </li>
                
                <li class="item d1" data-v-6239701c>
                    <div class="a-container">
                        <span
                            target_id="#查看日志"
                            class="catalog-aTag d1-aTag-title">
                            查看日志
                        </span>
                    </div>
                </li>
                
                <li class="item d1" data-v-6239701c>
                    <div class="a-container">
                        <span
                            target_id="#查看设备信息"
                            class="catalog-aTag d1-aTag-title">
                            查看设备信息
                        </span>
                    </div>
                </li>
                
                <li class="item d1" data-v-6239701c>
                    <div class="a-container">
                        <span
                            target_id="#修改设置"
                            class="catalog-aTag d1-aTag-title">
                            修改设置
                        </span>
                    </div>
                </li>
                
                <li class="item d1" data-v-6239701c>
                    <div class="a-container">
                        <span
                            target_id="#实用功能"
                            class="catalog-aTag d1-aTag-title">
                            实用功能
                        </span>
                    </div>
                </li>
                
                <li class="item d1" data-v-6239701c>
                    <div class="a-container">
                        <span
                            target_id="#刷机相关命令"
                            class="catalog-aTag d1-aTag-title">
                            刷机相关命令
                        </span>
                    </div>
                </li>
                
                <li class="item d1" data-v-6239701c>
                    <div class="a-container">
                        <span
                            target_id="#安全相关命令"
                            class="catalog-aTag d1-aTag-title">
                            安全相关命令
                        </span>
                    </div>
                </li>
                
                <li class="item d1" data-v-6239701c>
                    <div class="a-container">
                        <span
                            target_id="#更多 adb shell 命令"
                            class="catalog-aTag d1-aTag-title">
                            更多 adb shell 命令
                        </span>
                    </div>
                </li>
                
                <li class="item d1" data-v-6239701c>
                    <div class="a-container">
                        <span
                            target_id="#常见问题"
                            class="catalog-aTag d1-aTag-title">
                            常见问题
                        </span>
                    </div>
                </li>
                
                <li class="item d1" data-v-6239701c>
                    <div class="a-container">
                        <span
                            target_id="#adb 的非官方实现"
                            class="catalog-aTag d1-aTag-title">
                            adb 的非官方实现
                        </span>
                    </div>
                </li>
                
                <li class="item d1" data-v-6239701c>
                    <div class="a-container">
                        <span
                            target_id="#相关命令"
                            class="catalog-aTag d1-aTag-title">
                            相关命令
                        </span>
                    </div>
                </li>
                
                <li class="item d1" data-v-6239701c>
                    <div class="a-container">
                        <span
                            target_id="#致谢"
                            class="catalog-aTag d1-aTag-title">
                            致谢
                        </span>
                    </div>
                </li>
                
                <li class="item d1" data-v-6239701c>
                    <div class="a-container">
                        <span
                            target_id="#参考链接"
                            class="catalog-aTag d1-aTag-title">
                            参考链接
                        </span>
                    </div>
                </li>
                
                
            </ul>
        </div>
    </nav>

    <script type="text/javascript">
        $(".catalog-aTag").click(function(){
            let id = $(this).attr("target_id");
            $('html, body').animate({
                scrollTop: ($(id).offset().top-80)
            }, 798);
        });
        $(".direction").click(function(){
            $(".catalog-title").removeClass("collapse");
            $("#icon_expand_toogle").attr('class', "");
            if ($(".catalog-body").hasClass("fold")) {
                $(".catalog-body").removeClass("fold");
                $(".catalog-body").addClass("unfold");
                $(".direction>.word").text("收起");
                $("#icon_expand_toogle").attr('class', "icon-rotate");
            }else{
                $(".catalog-body").removeClass("unfold");
                $(".catalog-body").addClass("fold");
                $(".catalog-title").addClass("collapse");
                $(".direction>.word").text("展开");
            }
        });
        $(()=>{
            let tocArray = "基本用法,设备连接管理,应用管理,与应用交互,文件管理,模拟按键/输入,查看日志,查看设备信息,修改设置,实用功能,刷机相关命令,安全相关命令,更多 adb shell 命令,常见问题,adb 的非官方实现,相关命令,致谢,参考链接";
            let fixedTop = $("#jj_post_nav").offset().top;
            let stickyNav = ()=> {
                let scrollTop = $(window).scrollTop();
                // console.log(`scrollTop=${scrollTop} fixedTop=${fixedTop}`);
                if (scrollTop>fixedTop) {
                    $("#jj_post_nav").addClass("jj_sticky");
                } else {
                    $("#jj_post_nav").removeClass("jj_sticky");
                }
            };
            stickyNav();
            $(window).scroll(()=>{
                stickyNav();
            });
            $("#jj_post_nav").css("display",tocArray.length==0?"none":"");
        });
    </script>

</div>

                                </div>
                                <div data-v-125fc212
    class="article-suspended-panel dynamic-data-ready">
    <svg
        data-v-45561e54
        xmlns="http://www.w3.org/2000/svg"
        class
        style="display: none;">
        <symbol
            data-v-45561e54
            id="icon-comment"
            viewBox="0 0 20 20"
            xmlns="http://www.w3.org/2000/svg">
            <path
                data-v-45561e54
                fill-rule="evenodd"
                clip-rule="evenodd"
                d="M4.62739 1.25C2.9347 1.25 1.5625 2.6222 1.5625 4.31489L1.56396 12.643C1.56403 14.3356 2.9362 15.7078 4.62885 15.7078H6.48326L6.93691 17.6869L6.93884 17.6948C7.16894 18.6441 8.28598 19.0599 9.08073 18.4921L12.7965 15.7078H15.5001C17.1928 15.7078 18.565 14.3355 18.565 12.6428L18.5635 4.31477C18.5635 2.62213 17.1913 1.25 15.4986 1.25H4.62739ZM5.98265 9.89255C6.68783 9.89255 7.2595 9.32089 7.2595 8.61571C7.2595 7.91053 6.68783 7.33887 5.98265 7.33887C5.27747 7.33887 4.70581 7.91053 4.70581 8.61571C4.70581 9.32089 5.27747 9.89255 5.98265 9.89255ZM9.95604 9.89255C10.6612 9.89255 11.2329 9.32089 11.2329 8.61571C11.2329 7.91053 10.6612 7.33887 9.95604 7.33887C9.25086 7.33887 8.6792 7.91053 8.6792 8.61571C8.6792 9.32089 9.25086 9.89255 9.95604 9.89255ZM15.2124 8.61571C15.2124 9.32089 14.6407 9.89255 13.9355 9.89255C13.2304 9.89255 12.6587 9.32089 12.6587 8.61571C12.6587 7.91053 13.2304 7.33887 13.9355 7.33887C14.6407 7.33887 15.2124 7.91053 15.2124 8.61571Z"></path>
        </symbol>
        <symbol
            data-v-45561e54 id="icon-zan"
            viewBox="0 0 20 20"
            xmlns="http://www.w3.org/2000/svg">
            <path
                data-v-45561e54
                fill-rule="evenodd"
                clip-rule="evenodd"
                d="M10.4167 6.40399C5.35406 6.40399 1.25 10.5675 1.25 15.7035C1.25 16.0225 1.28448 16.4512 1.35344 16.9898C1.36807 17.1039 1.47243 17.1846 1.58655 17.17C1.6483 17.1621 1.70328 17.127 1.73643 17.0743L1.86865 16.8676C1.99553 16.6731 2.10644 16.5147 2.20137 16.3925C3.69554 14.4692 6.13777 13.3823 9.35515 13.3378L10.4167 13.3364V17.0757C10.4167 17.3101 10.6086 17.5 10.8453 17.5C10.959 17.5 11.068 17.4553 11.1483 17.3757L18.145 10.45C18.3961 10.2015 18.3961 9.79853 18.145 9.55L11.1483 2.62426C10.981 2.45858 10.7096 2.45858 10.5422 2.62426C10.4618 2.70383 10.4167 2.81174 10.4167 2.92426V6.40399Z"></path>
        </symbol>
        <symbol
            data-v-45561e54
            id="icon-immerse"
            viewBox="0 0 1024 1024"
            xmlns="http://www.w3.org/2000/svg">
            <path
                data-v-45561e54
                fill-rule="evenodd"
                clip-rule="evenodd"
                d="M535.466667 241.066667c-12.8-8.533333-27.733333-8.533333-40.533334 0L183.466667 488.533333c-6.4 6.4-12.8 14.933333-12.8 23.466667 0 2.133333 0 6.4 2.133333 8.533333 2.133333 12.8 14.933333 21.333333 27.733333 21.333334h155.733334v322.133333c0 19.2 12.8 29.866667 32 29.866667h249.6c21.333333 0 34.133333-12.8 34.133333-29.866667v-320h151.466667c12.8 0 25.6-8.533333 27.733333-21.333333s0-25.6-8.533333-34.133334L535.466667 241.066667zM864 96h-704C142.933333 96 128 110.933333 128 128s14.933333 32 32 32h704c17.066667 0 32-14.933333 32-32s-14.933333-32-32-32z"></path>
        </symbol>
    </svg>
    <div data-v-45561e54 badge="222"
        class="panel-btn with-badge-x">
        <svg
            data-v-6e70c50a
            data-v-45561e54
            class="sprite-icon icon-zan">
            <use
                data-v-6e70c50a
                xlink:href="#icon-zan">
            </use>
        </svg>
    </div>
    <div data-v-45561e54 badge="109"
        class="panel-btn with-badge-x" id="toolbar_btn_comment">
        <svg
            data-v-6e70c50a data-v-45561e54
            class="sprite-icon icon-comment">
            <use
                data-v-6e70c50a
                xlink:href="#icon-comment">
            </use>
        </svg>
    </div>
    <div data-v-45561e54 class="panel-btn" id="toolbar_btn_top">
        <svg
            data-v-6e70c50a
            data-v-45561e54
            class="sprite-icon icon-report">
            <use
                data-v-6e70c50a
                xlink:href="#icon-immerse">
            </use>
        </svg>
    </div>
    <script type="text/javascript">
        $("#toolbar_btn_comment").click(()=>{
            $('html, body').animate({
                scrollTop: ($('#comment-card').offset().top - 120)
            }, 798);
        });
        $("#toolbar_btn_top").click(()=>{
            $('html, body').animate({
                scrollTop: 0
            }, 798);
        });
    </script>
</div>
                            </div>
                        </main>
                    </div>
                    <div class="global-component-box">

                    </div>

                </div>
            </div>
        </div>
    </body>

</html>